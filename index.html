<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>å‘½ãƒ»é‹ãƒ»åœï½œæ•°ç§˜ï¼‹å®¿æ›œï¼‹ä¹æ˜Ÿ ç›¸æ€§ï¼†ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</title>
<style>
  :root{
    --bg:#0a0f13; --panel:#111826; --ink:#eaf1ff; --muted:#9fb1cf;
    --accent:#22d3ee; --accent2:#34d399; --line:#223049;
    --good:#34d399; --warn:#fbbf24; --bad:#f87171;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;background:#05080c;color:var(--ink);line-height:1.85}
  header{padding:26px 16px;text-align:center;background:linear-gradient(180deg,#0a0f13,#0a1320)}
  header h1{margin:0 0 6px;font-size:24px;letter-spacing:.04em}
  header p{margin:0;color:var(--muted)}
  main{max-width:1120px;margin:0 auto;padding:16px}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:18px;margin:14px 0;box-shadow:0 8px 24px rgba(0,0,0,.26)}
  .grid{display:grid;gap:14px}
  @media(min-width:920px){.grid{grid-template-columns:2fr 3fr}}
  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
  input,select,button{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:#0b1422;color:var(--ink)}
  button{cursor:pointer;background:linear-gradient(45deg,var(--accent),var(--accent2));border:none;font-weight:700}
  h2{margin:0 0 8px;font-size:18px}
  h3{margin:14px 0 8px;font-size:16px}
  p{margin:.6em 0}
  ul{margin:.4em 0 .8em 1.2em}
  .kpi{display:flex;gap:10px;flex-wrap:wrap;margin:6px 0}
  .kpi div{background:#0b1422;border:1px solid var(--line);padding:8px 12px;border-radius:10px}
  .pill{display:inline-block;border:1px solid var(--line);padding:2px 8px;border-radius:999px;margin-right:6px;color:var(--muted);font-size:12px}
  .muted{color:var(--muted)}
  .good{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .calendar{display:grid;gap:10px}
  @media(min-width:920px){.calendar{grid-template-columns:repeat(3,1fr)}}
  .mon{border:1px solid var(--line);border-radius:12px;padding:10px;background:#0b1422}
  .tag{display:inline-block;font-size:11px;border:1px solid var(--line);border-radius:6px;padding:1px 6px;margin-right:4px;margin-bottom:4px}
  .t-good{color:var(--good);border-color:#184e3a}
  .t-warn{color:var(--warn);border-color:#7c4a03}
  .t-bad{color:var(--bad);border-color:#5b2323}
  .flex{display:flex;gap:10px;flex-wrap:wrap}
  .split{display:grid;gap:12px}
  @media(min-width:920px){.split{grid-template-columns:1fr 1fr}}
  .small{font-size:12px}
  .section{margin-top:6px}
  .box{background:#0c1728;border:1px dashed #27405f;padding:10px;border-radius:10px}
  .lead{font-size:15px}
  .row{display:grid;gap:10px}
  @media(min-width:720px){.row{grid-template-columns:1fr 1fr}}
  .subtitle{font-weight:700;color:#cfe0ff}
  .hr{height:1px;background:#1e2d44;margin:10px 0}
</style>
</head>
<body>
<header>
  <h1>å‘½ãƒ»é‹ãƒ»åœï½œæ•°ç§˜ï¼‹å®¿æ›œï¼‹ä¹æ˜Ÿ</h1>
  <p>ç”Ÿå¹´æœˆæ—¥ã ã‘ã§ã€Œæœ¬è³ªãƒ»æ™‚æœŸãƒ»ç›¸æ€§ã€ã‚’ãƒ¯ãƒ³ãƒšãƒ¼ã‚¸ã§ã€‚3å¹´ã®å¥½æ©Ÿã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ä»˜ãã€‚</p>
</header>
<main>
  <!-- å…¥åŠ› -->
  <div class="card grid">
    <div>
      <label>ã‚ãªãŸã®ç”Ÿå¹´æœˆæ—¥</label>
      <input type="date" id="birthA" />
      <div class="flex">
        <div style="flex:1">
          <label>å‡ºç”Ÿæ™‚åˆ»ï¼ˆä»»æ„ï¼‰</label>
          <input type="time" id="timeA" step="60" />
        </div>
        <div style="flex:1">
          <label>æ€§åˆ¥ï¼ˆä»»æ„ï½œæ–‡ä½“ã«åæ˜ ï¼‰</label>
          <select id="genderA">
            <option value="">æŒ‡å®šãªã—</option><option value="female">å¥³æ€§</option><option value="male">ç”·æ€§</option>
          </select>
        </div>
      </div>
      <div class="hr"></div>
      <label>ç›¸æ€§ãƒã‚§ãƒƒã‚¯ï¼ˆä»»æ„ï¼‰ãƒ»ç›¸æ‰‹ã®ç”Ÿå¹´æœˆæ—¥</label>
      <input type="date" id="birthB" />
      <div class="flex">
        <div style="flex:1">
          <label>ç›¸æ‰‹ã®å‡ºç”Ÿæ™‚åˆ»ï¼ˆä»»æ„ï¼‰</label>
          <input type="time" id="timeB" step="60" />
        </div>
        <div style="flex:1">
          <label>ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³</label>
          <select id="tz">
            <option value="">è‡ªå‹•ï¼ˆç«¯æœ«TZï¼‰</option>
            <option value="9">æ—¥æœ¬ï¼ˆUTC+9ï¼‰</option>
            <option value="0">UTCÂ±0</option>
            <option value="-5">NYï¼ˆUTC-5ï¼‰</option>
            <option value="1">CETï¼ˆUTC+1ï¼‰</option>
          </select>
        </div>
      </div>
      <div style="margin-top:12px"><button id="run">é‘‘å®šã™ã‚‹</button></div>
      <p class="small muted">â€»å®¿æ›œã¯æœˆã®é»„çµŒã‹ã‚‰27å®¿ã‚’ç®—å‡ºã™ã‚‹ç°¡æ˜“é«˜ç²¾åº¦ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆMeeusç³»ï¼‰ã‚’ä½¿ç”¨ã€‚æ™‚åˆ»ä¸æ˜ã¯æ­£åˆã§æ¨å®šã€‚</p>
    </div>
    <div>
      <div class="kpi">
        <div><strong>ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹</strong>ï¼š<span id="lifePath">â€”</span></div>
        <div><strong>æœ¬å‘½å®¿</strong>ï¼š<span id="shukuA">â€”</span></div>
        <div><strong>ä¹æ˜Ÿï¼ˆæœ¬å‘½æ˜Ÿï¼‰</strong>ï¼š<span id="kuseiA">â€”</span></div>
        <div><strong>ä»Šå¹´ã®å€‹äººå¹´</strong>ï¼š<span id="pyear">â€”</span></div>
      </div>
      <div class="muted small">ä¸‹ã®å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«èª­ã‚ã‚‹æ–‡ç« ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã¾ã™ï¼ˆãã®ã¾ã¾ã‚³ãƒ”ãƒšOKï¼‰ã€‚</div>
    </div>
  </div>

  <!-- å‘½ -->
  <div class="card">
    <h2>â‘  å‘½ï¼ˆæœ¬è³ªï¼‰</h2>
    <div id="sectionMei" class="section"></div>
  </div>

  <!-- é‹ -->
  <div class="card">
    <h2>â‘¡ é‹ï¼ˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰</h2>
    <div id="sectionUn" class="section"></div>
  </div>

  <!-- åœ -->
  <div class="card">
    <h2>â‘¢ åœï¼ˆã„ã¾ã®ãƒ†ãƒ¼ãƒï¼‰</h2>
    <div id="sectionBoku" class="section"></div>
  </div>

  <!-- 3å¹´ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -->
  <div class="card">
    <h2>ğŸ”­ 3å¹´ã®å¥½æ©Ÿã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼ˆæ‹æ„›ãƒ»çµå©šãƒ»å‡ºä¼šã„ãƒ»å¼•è¶Šã—ãƒ»è»¢è·ï¼‰</h2>
    <p class="small muted">æ•°ç§˜ã®å€‹äººæœˆï¼‹å®¿æ›œã®æ€§è³ªã§ã‚¿ã‚°è¡¨ç¤ºã€‚â€»é‡è¦æ¡ˆä»¶ã¯å€‹åˆ¥ã«å†ç¢ºèªã‚’ã€‚</p>
    <div id="calendar" class="calendar"></div>
  </div>

  <!-- å®¿æ›œ ç›¸æ€§ -->
  <div class="card">
    <h2>å®¿æ›œã®ç›¸æ€§ï¼ˆå®‰ãƒ»æ „ãƒ»å±ãƒ»æˆãƒ»å‘½ãƒ»å‹ãƒ»æ¥­ãƒ»èƒãƒ»è¡°ãƒ»å£Šï¼‰</h2>
    <div id="compat" class="section"></div>
    <p class="small muted">â€»æœ¬å®Ÿè£…ã¯è·é›¢æ–¹å¼ã®<strong>ç°¡æ˜“ç‰ˆ</strong>ã€‚æµæ´¾ã«ã‚ˆã‚Šç•°ãªã‚‹ãŸã‚ã€é‹ç”¨å…ˆã®ç›¸æ€§è¡Œåˆ—JSONã‚’å·®ã—æ›¿ãˆå¯èƒ½ã€‚</p>
  </div>

  <!-- ä¹æ˜Ÿ æ°—å­¦ -->
  <div class="card">
    <h2>ä¹æ˜Ÿæ°—å­¦ï½œæœ¬å‘½æ˜Ÿã¨æ–¹ä½ã®ç›®å®‰</h2>
    <div id="kigaku" class="section"></div>
  </div>

  <!-- è·æ¥­ï¼†æƒ¹ã‹ã‚Œã‚„ã™ã„ã‚¿ã‚¤ãƒ— -->
  <div class="card">
    <h2>å‘ã„ã¦ã„ã‚‹è·æ¥­ãƒ»æƒ¹ã‹ã‚Œã‚„ã™ã„ã‚¿ã‚¤ãƒ—ï¼ˆèª­ã¿ã‚„ã™ã„é•·æ–‡ï¼‰</h2>
    <div id="sectionCareerLove" class="section"></div>
  </div>

  <div class="card small muted">
    <strong>å…è²¬ï¼š</strong>æœ¬ãƒ„ãƒ¼ãƒ«ã¯ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°è£œåŠ©ã§ã™ã€‚åŒ»ç™‚ãƒ»æ³•å‹™ãƒ»æŠ•è³‡åˆ¤æ–­ã®ä»£æ›¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å®¿æ›œã¨ä¹æ˜Ÿã¯æš¦åŸºæº–ãƒ»æµæ´¾ã«ã‚ˆã‚Šå·®ç•°ãŒã‚ã‚Šã¾ã™ã€‚é‡è¦åˆ¤æ–­ã¯è¤‡æ•°æ‰‹æ³•ã§ã‚¯ãƒ­ã‚¹ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
  </div>
</main>

<script>
/* ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ===== */
const deg2rad=d=>d*Math.PI/180, rad2deg=r=>r*180/Math.PI, norm360=x=>(x%360+360)%360;
function toDateWithTZ(dateStr,timeStr,tzHours){
  const [y,m,d]=dateStr.split("-").map(Number);
  let H=12,MIN=0; if(timeStr){const t=timeStr.split(":");H=+t[0];MIN=+t[1];}
  const tz=(tzHours==null||tzHours==="")?-(new Date().getTimezoneOffset()/60):Number(tzHours);
  return new Date(Date.UTC(y,m-1,d,H - tz,MIN));
}
function julianDay(utc){
  const y=utc.getUTCFullYear(), m=utc.getUTCMonth()+1;
  const D=utc.getUTCDate()+(utc.getUTCHours()+utc.getUTCMinutes()/60)/24;
  let Y=y,M=m; if(M<=2){Y--;M+=12;}
  const A=Math.floor(Y/100), B=2-A+Math.floor(A/4);
  return Math.floor(365.25*(Y+4716))+Math.floor(30.6001*(M+1))+D+B-1524.5;
}

/* ===== æœˆé»„çµŒâ†’å®¿æ›œ ===== */
function moonLon(utc){
  const JD=julianDay(utc), T=(JD-2451545)/36525;
  const L0=norm360(218.3164477+481267.88123421*T-0.0015786*T*T+T*T*T/538841-T*T*T*T/65194000);
  const D =norm360(297.8501921+445267.1114034*T-0.0018819*T*T+T*T*T/545868-T*T*T*T/113065000);
  const M =norm360(357.5291092+35999.0502909*T-0.0001536*T*T+T*T*T/24490000);
  const M1=norm360(134.9633964+477198.8675055*T+0.0087414*T*T+T*T*T/69699-T*T*T*T/14712000);
  const F =norm360(93.2720950 +483202.0175233*T-0.0036539*T*T-T*T*T/3526000+T*T*T*T/863310000);
  let lon=L0
    +6.289*Math.sin(deg2rad(M1))
    +1.274*Math.sin(deg2rad(2*D-M1))
    +0.658*Math.sin(deg2rad(2*D))
    +0.214*Math.sin(deg2rad(2*M1))
    +0.186*Math.sin(deg2rad(M))
    -0.114*Math.sin(deg2rad(2*F));
  return norm360(lon);
}
const SHUKU=[
 "è§’æœ¨è›Ÿ","äº¢é‡‘é¾","æ°åœŸè²‰","æˆ¿æ—¥å…","å¿ƒæœˆç‹","å°¾ç«è™","ç®•æ°´è±¹",
 "æ–—æœ¨ç¬","å¥³åœŸè ","è™šæ—¥é¼ ","å±æœˆç‡•","å®¤ç«çŒª","å£æ°´è²",
 "å¥æœ¨ç‹¼","å©é‡‘ç‹—","èƒƒåœŸé›‰","æ˜´æ—¥éµ ","ç•¢æœˆçƒ","è§œç«çŒ´","å‚æ°´çŒ¿",
 "äº•æœ¨çŠ´","é¬¼é‡‘ç¾Š","æŸ³åœŸç","æ˜Ÿæ—¥é¦¬","å¼µæœˆé¹¿","ç¿¼ç«è›‡","è»«æ°´èš“"
];
function shukuOf(utc){ const lon=moonLon(utc); const idx=Math.floor(lon/(360/27)); return {name:SHUKU[idx],idx}; }

/* ===== æ•°ç§˜ ===== */
function sumDigits(n){return String(n).split("").reduce((a,b)=>a+Number(b),0);}
function reduceNum(n){ if([11,22,33].includes(n))return n; let r=n; while(r>9) r=sumDigits(r); return r; }
function lifePath(y,m,d){ const t=sumDigits(y)+sumDigits(m)+sumDigits(d); return [11,22,33].includes(t)?t:reduceNum(t); }
function pYear(bY,bM,bD,year){ return reduceNum(reduceNum(bM+bD)+reduceNum(year)); }
function pMonth(pyear,month){ return reduceNum(pyear+month); }

/* ===== ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç°¡æ˜“ ===== */
const LP_PROFILE={
  1:{title:"é–‹æ‹“è€…",traits:"è‡ªç«‹ãƒ»æ±ºæ–­ãƒ»ã‚¹ãƒ”ãƒ¼ãƒ‰",love:"å°Šæ•¬ã§ãã‚‹äºº",careers:["èµ·æ¥­å®¶","æ³•äººå–¶æ¥­","ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚»ãƒ¼ãƒ«ã‚¹","åº—èˆ—çµŒå–¶","ä¼ç”»è²¬ä»»è€…","ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼","æ•‘æ€¥/æ¶ˆé˜²/è‡ªè¡›éšŠ","ã‚¹ãƒãƒ¼ãƒ„ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼","ã‚¤ãƒ™ãƒ³ãƒˆãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼"]},
  2:{title:"èª¿å’Œè€…",traits:"å…±æ„Ÿãƒ»é€šè¨³ãƒ»æ©‹æ¸¡ã—",love:"å„ªã—ã•ã¨å®‰å¿ƒæ„Ÿ",careers:["äººäº‹","æ¡ç”¨ã‚³ãƒ¼ãƒ‡ã‚£ãƒãƒ¼ã‚¿ãƒ¼","ç§˜æ›¸","é€šè¨³","åŒ»ç™‚äº‹å‹™","ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼","ä¿è‚²å£«","CS/ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ","å¸ä¼š"]},
  3:{title:"è¡¨ç¾è€…",traits:"ç™ºæƒ³ãƒ»è¨€èªåŒ–ãƒ»PR",love:"ä¼šè©±ã¨ãƒ¦ãƒ¼ãƒ¢ã‚¢",careers:["åºƒå ±","ã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ã‚¿ãƒ¼","ç·¨é›†è€…","ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼","å‹•ç”»ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼","SNSé‹ç”¨","MC/å¸ä¼š","è¬›å¸«","ã‚¿ãƒ¬ãƒ³ãƒˆ/é…ä¿¡è€…"]},
  4:{title:"æ§‹ç¯‰è€…",traits:"ä»•çµ„åŒ–ãƒ»ä¿¡é ¼ãƒ»ç¶™ç¶š",love:"èª å®Ÿã•",careers:["çµŒç†","ç·å‹™","å“è³ªç®¡ç†","ä½å®…/ä¸å‹•ç”£","å…¬å‹™å“¡","å€‰åº«/ãƒ­ã‚¸","ã‚·ã‚¹ãƒ†ãƒ é‹ç”¨","è£½é€ ãƒ©ã‚¤ãƒ³è²¬ä»»è€…","è­¦å‚™"]},
  5:{title:"å¤‰åŒ–æ¨é€²",traits:"è‡ªç”±ãƒ»æ—…ãƒ»åˆ·æ–°",love:"åˆºæ¿€ã¨è‡ªç”±",careers:["æ—…è¡Œæ¥­","ãƒ„ã‚¢ãƒ¼ã‚³ãƒ³ãƒ€ã‚¯ã‚¿ãƒ¼","è¶Šå¢ƒEC","åºƒå‘Šå–¶æ¥­","ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢","ãƒ™ãƒ³ãƒãƒ£ãƒ¼æ–°è¦äº‹æ¥­","ãƒªãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³/å¼•è¶Šé–¢é€£","ãƒ©ã‚¤ãƒ‰ã‚·ã‚§ã‚¢/é‹è¼¸","é€šè¨³ã‚¬ã‚¤ãƒ‰"]},
  6:{title:"è²¬ä»»ã¨æ„›",traits:"é¢å€’è¦‹ãƒ»ç¾æ„è­˜ãƒ»èª¿æ•´",love:"å®¶æ—è¦³ã®ä¸€è‡´",careers:["çœ‹è­·å¸«","ç†å­¦ç™‚æ³•å£«","æ•™å¸«","ãƒ˜ã‚¢ãƒ¡ã‚¤ã‚¯","ãƒ•ãƒ©ãƒ¯ãƒ¼/ãƒ–ãƒ©ã‚¤ãƒ€ãƒ«","ã‚¤ãƒ³ãƒ†ãƒªã‚¢","äººäº‹åŠ´å‹™","åº—èˆ—SV","CA/ã‚°ãƒ©ãƒ³ãƒ‰ã‚¹ã‚¿ãƒƒãƒ•"]},
  7:{title:"æ¢ç©¶è€…",traits:"åˆ†æãƒ»å°‚é–€æ€§ãƒ»ç²¾ç¥æ€§",love:"çŸ¥æ€§ã¨è·é›¢æ„Ÿ",careers:["ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆ","ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢","ç ”ç©¶è·","è–¬å‰¤å¸«","æ³•å¾‹/ç‰¹è¨±","å ã„å¸«/ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼","ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢","å­¦èŠ¸å“¡","ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼"]},
  8:{title:"å®Ÿç¾è€…",traits:"æˆæœãƒ»ãƒãƒãƒ¼ãƒ»çµ±ç‡",love:"ä»•äº‹ç†è§£",careers:["çµŒå–¶è€…","é‡‘è/æŠ•è³‡","ä¸å‹•ç”£é–‹ç™º","å–¶æ¥­çµ±æ‹¬","ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆ","å•†ç¤¾","ãƒã‚¤ãƒ¤ãƒ¼","å¤–è³‡ã‚»ãƒ¼ãƒ«ã‚¹","åº—èˆ—ãƒã‚§ãƒ¼ãƒ³è²¬ä»»è€…"]},
  9:{title:"å¥‰ä»•è€…",traits:"åšæ„›ãƒ»å…±æ„Ÿãƒ»èŠ¸è¡“",love:"ä¸–ç•Œè¦³ã®ä¸€è‡´",careers:["ç¤¾ä¼šç¦ç¥‰å£«","å¿ƒç†å£«","NPO/ã‚½ãƒ¼ã‚·ãƒ£ãƒ«","éŸ³æ¥½å®¶","å†™çœŸå®¶","èˆå°æ¼”å‡º","åŒ»ç™‚ã‚½ãƒ¼ã‚·ãƒ£ãƒ«","åœ°åŸŸãŠã“ã—","å›½éš›å”åŠ›"]},
  11:{title:"å•“ç™ºè€…",traits:"ç›´æ„Ÿãƒ»ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«ãƒ»ç™ºä¿¡",love:"æ³¢é•·ã®ä¸€è‡´",careers:["ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼","è¬›æ¼”å®¶","ä½œè©/ä½œå®¶","ãƒ’ãƒ¼ãƒ©ãƒ¼","å†™çœŸ/æ˜ åƒè¡¨ç¾","ãƒ¨ã‚¬/ç‘æƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ¼","å æ˜Ÿè¡“å¸«","ã‚¢ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼"]},
  22:{title:"å¤§å™¨æ§‹ç¯‰",traits:"ç¤¾ä¼šçš„äº‹æ¥­ãƒ»ç¾å®ŸåŒ–",love:"å¤§å¿—ã‚’å…±æœ‰",careers:["å»ºè¨­/ã‚¤ãƒ³ãƒ•ãƒ©PM","ãƒ—ãƒ©ãƒ³ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢","éƒ½å¸‚è¨ˆç”»","ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼","å¤§å‹è³‡é‡‘èª¿é”","æ•™è‚²ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ é‹å–¶","ç—…é™¢/å­¦æ ¡çµŒå–¶"]},
  33:{title:"ç„¡æ¡ä»¶ã®æ„›",traits:"ãƒ’ãƒ¼ãƒªãƒ³ã‚°ãƒ»èŠ¸è¡“çš„å¥‰ä»•",love:"åŒ…å®¹åŠ›",careers:["å°å…/è¨ªå•çœ‹è­·","ä½œæ¥­ç™‚æ³•","ä¿è‚²/ç™‚è‚²","éŸ³æ¥½/ã‚¢ãƒ¼ãƒˆç™‚æ³•å£«","æ–™ç†å®¶","ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼","ãƒãƒ£ãƒªãƒ†ã‚£é‹å–¶","ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼"]}
};
const SHUKU_PROFILE={
  "è§’æœ¨è›Ÿ":{type:"å’Œå–„",keywords:"å§‹å‹•ãƒ»å‰µé€ ãƒ»ç™ºå±•",love:"æƒ…ã§å‹•ãã€‚ç›¸æ‰‹ã®æˆé•·ã‚’æ”¯ãˆåˆã†ã€‚",career:"èµ·æ¥­/å–¶æ¥­/ä¼ç”»/é–‹ç™º"},
  "äº¢é‡‘é¾":{type:"å’Œå–„",keywords:"çŸœæŒãƒ»æ­£ç¾©ãƒ»è«–ç†",love:"å°Šæ•¬ã§ãã‚‹çŸ¥æ€§ã«æƒ¹ã‹ã‚Œã‚‹ã€‚",career:"æ³•å‹™/äº¤æ¸‰/æ•™è‚²/ç›£æŸ»"},
  "æ°åœŸè²‰":{type:"å’Œå–„",keywords:"æ•´ãˆã‚‹ãƒ»èª¿æ•´å½¹",love:"ç©ã‚„ã‹ã§å®‰å®šå¿—å‘ã€‚",career:"äº‹å‹™/çµŒç†/ç·¨é›†/èª¿æ•´PM"},
  "æˆ¿æ—¥å…":{type:"å’Œå–„",keywords:"äººæ°—ãƒ»è¯",love:"æ¥½ã—ã„äºº/è¦‹ãŸç›®â—",career:"æ¥å®¢/ç¾å®¹/ã‚¨ãƒ³ã‚¿ãƒ¡/åºƒå ±"},
  "å¿ƒæœˆç‹":{type:"å’Œå–„",keywords:"æ„Ÿå—æ€§ãƒ»å…±æ„Ÿ",love:"ç¹Šç´°ã•ã¨ã‚„ã•ã—ã•ã€‚",career:"ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°/èŠ¸è¡“/åŸ·ç­†"},
  "å°¾ç«è™":{type:"æ€¥é€Ÿ",keywords:"æƒ…ç†±ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼",love:"ä¸€ç›´ç·šã€‚ãƒ©ã‚¤ãƒãƒ«ãŒç‡ƒæ–™ã€‚",career:"ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ/èˆå°/ã‚¹ãƒãƒ¼ãƒ„"},
  "ç®•æ°´è±¹":{type:"æ€¥é€Ÿ",keywords:"ç™ºä¿¡ãƒ»æ‹¡æ•£",love:"è¨€è‘‰ã®ç›¸æ€§ã€‚",career:"ãƒ¡ãƒ‡ã‚£ã‚¢/ãƒãƒ¼ã‚±/æ•™è‚²/IT"},
  "æ–—æœ¨ç¬":{type:"å’Œå–„",keywords:"å®ˆã‚‹ãƒ»å …å®Ÿ",love:"å®¶æ—è¦³é‡è¦–ã€‚",career:"ä¸å‹•ç”£/é£Ÿ/ä¿å®ˆ"},
  "å¥³åœŸè ":{type:"å’Œå–„",keywords:"æ°—é…ã‚Šãƒ»è‚²ã‚€",love:"å°½ãã™æ„›ã€‚",career:"çœ‹è­·/ä¿è‚²/äººäº‹/ãƒãƒƒã‚¯ã‚ªãƒ•ã‚£ã‚¹"},
  "è™šæ—¥é¼ ":{type:"å‡¶å„",keywords:"ç©ºå›ã‚Šæ³¨æ„",love:"ç†æƒ³åŒ–ã«æ³¨æ„ã€‚",career:"è¶³å ´å›ºã‚"},
  "å±æœˆç‡•":{type:"æ€¥é€Ÿ",keywords:"ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒ»ç©º",love:"è‡ªç”±ãªè·é›¢æ„Ÿã€‚",career:"ç‰©æµ/æ—…è¡Œ/ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–"},
  "å®¤ç«çŒª":{type:"å’Œå–„",keywords:"æ§‹ç¯‰ãƒ»ä¿¡ç”¨",love:"ä¿¡é ¼ãƒ™ãƒ¼ã‚¹ã€‚",career:"å»ºè¨­/é‡‘è/å“è³ª"},
  "å£æ°´è²":{type:"å’Œå–„",keywords:"ä¿å…¨ãƒ»æ´å¯Ÿ",love:"èŠ¯ã®å¼·ã•ã€‚",career:"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/ç ”ç©¶/ç›£æŸ»"},
  "å¥æœ¨ç‹¼":{type:"å’Œå–„",keywords:"ä¼ç”»ãƒ»ç·¨é›†",love:"è¨€èªæ„Ÿè¦šã€‚",career:"ç·¨é›†/ä¼ç”»/UX/PM"},
  "å©é‡‘ç‹—":{type:"å’Œå–„",keywords:"å‡ å¸³é¢ãƒ»è·äºº",love:"èª å®Ÿç¬¬ä¸€ã€‚",career:"è·äºº/æ•´å‚™/åŒ»ç™‚/çµŒç†"},
  "èƒƒåœŸé›‰":{type:"å’Œå–„",keywords:"è¡£é£Ÿä½ãƒ»å®Ÿå‹™",love:"ç”Ÿæ´»åŠ›é‡è¦–ã€‚",career:"é£²é£Ÿ/å°å£²/ä»‹è­·"},
  "æ˜´æ—¥éµ ":{type:"æ€¥é€Ÿ",keywords:"ã‚¹ã‚¿ãƒ¼æ€§",love:"ç›´çƒå‹è² ã€‚",career:"è¡¨ç¾/å–¶æ¥­/èˆå°"},
  "ç•¢æœˆçƒ":{type:"å’Œå–„",keywords:"ç©ã¿ä¸Šã’",love:"ç¶™ç¶šåŠ›ã€‚",career:"å…¬å‹™/é‡‘è/ãƒ¡ãƒ¼ã‚«ãƒ¼"},
  "è§œç«çŒ´":{type:"æ€¥é€Ÿ",keywords:"è¨€è«–ãƒ»æŠ€è¡“",love:"ä¼šè©±ã§æƒ¹ã‹ã‚Œã‚‹ã€‚",career:"IT/ç ”ç©¶/æ³•å¾‹/åˆ†æ"},
  "å‚æ°´çŒ¿":{type:"æ€¥é€Ÿ",keywords:"çªç ´ãƒ»æ”¹é©",love:"ç‹¬ç«‹å¿ƒã€‚",career:"èµ·æ¥­/æ–°è¦äº‹æ¥­/ã‚³ãƒ³ã‚µãƒ«"},
  "äº•æœ¨çŠ´":{type:"å’Œå–„",keywords:"å­¦ã³ãƒ»ç²¾ç¥",love:"ç²¾ç¥æ€§ã®åˆè‡´ã€‚",career:"æ•™è‚²/å®—æ•™/æ²»ç™‚"},
  "é¬¼é‡‘ç¾Š":{type:"å‡¶å„",keywords:"è­¦æˆ’ãƒ»æ…é‡",love:"åˆºæ¿€ã«æ³¨æ„ã€‚",career:"å®ˆã‚Š/æ”¹å–„/å†…çœ"},
  "æŸ³åœŸç":{type:"æ€¥é€Ÿ",keywords:"ã—ãªã‚„ã‹",love:"è‡ªç”±Ã—èª å®Ÿã€‚",career:"æ¥å®¢/è¦³å…‰/ãƒ™ãƒ³ãƒãƒ£ãƒ¼"},
  "æ˜Ÿæ—¥é¦¬":{type:"æ€¥é€Ÿ",keywords:"é å¾ãƒ»æµ·å¤–",love:"å†’é™ºå¿ƒã€‚",career:"è²¿æ˜“/å¤–è³‡/äº¤é€š"},
  "å¼µæœˆé¹¿":{type:"å’Œå–„",keywords:"é­…ã›ã‚‹ãƒ»ä½™è£•",love:"å™¨ã®å¤§ãã•ã€‚",career:"åºƒå ±/å¸ä¼š/èŠ¸èƒ½/æ¥å®¢"},
  "ç¿¼ç«è›‡":{type:"æ€¥é€Ÿ",keywords:"æˆ¦ç•¥ãƒ»é‹­æ•",love:"ãƒªã‚¹ãƒšã‚¯ãƒˆã€‚",career:"æˆ¦ç•¥/åˆ†æ/é‡‘è"},
  "è»«æ°´èš“":{type:"å’Œå–„",keywords:"ç™’ã‚„ã—ãƒ»æ—…ç«‹ã¡",love:"åŒ…å®¹åŠ›ã€‚",career:"åŒ»ç™‚/ç¦ç¥‰/æ”¯æ´/ç§»å‹•"}
};

/* ===== å®¿æ›œ ç›¸æ€§ï¼ˆç°¡æ˜“è·é›¢æ–¹å¼ï¼‰ =====
   27å®¿ã‚’å††ç’°ã¨ã—ã€Aâ†’Bã®è·é›¢ã§é–¢ä¿‚ã‚’å‰²ã‚Šå½“ã¦ã‚‹è¿‘ä¼¼ã€‚
   â€»æµæ´¾ã®è©³ç´°è¡Œåˆ—ã«å·®ã—æ›¿ãˆã‚‹å ´åˆã¯ COMP_MATRIX ã‚’ä¸Šæ›¸ãã—ã¦ãã ã•ã„ã€‚ */
const REL_TEXT={
  "å‘½":"åŒè³ªã§æ·±ã„ç¸ã€‚ä¼¼ã™ãã«ã‚ˆã‚‹æ‘©æ“¦ã¯ã€Œå½¹å‰²åˆ†æ‹…ã€ã§å›é¿ã€‚",
  "å‹":"é•·ã„å‹ç¸ã€‚è‡ªç„¶ä½“ã§æ”¯ãˆåˆãˆã‚‹ã€‚",
  "æˆ":"å®Ÿå‹™ãŒé€²ã‚€é–¢ä¿‚ã€‚ä»•äº‹ãƒ»çµå©šã®ç¾å®ŸåŠ›â—ã€‚",
  "å±":"åˆºæ¿€å¼·ã‚ã€‚çŸ­æœŸã¯ç‡ƒãˆã‚‹ãŒæ…é‡ã«ã€‚",
  "å®‰":"å®‰å¿ƒãƒ»åº‡è­·ã€‚ç”˜ãˆã™ãæ³¨æ„ã€‚",
  "æ „":"å¼•ãä¸Šã’åˆã†è¯ã®ç¸ã€‚è¦‹æ „ã«æ³¨æ„ã€‚",
  "è¡°":"åŠ›ã‚’æŠœã„ã¦æ•´ãˆã‚‹å­¦ã³ã®ç¸ã€‚",
  "å£Š":"ä¾¡å€¤è¦³ãŒã¶ã¤ã‹ã‚Šã‚„ã™ã„ã€‚å¢ƒç•Œç·šã‚’æ˜ç¢ºã«ã€‚",
  "æ¥­":"å‰ä¸–ã®è²¸ã—å€Ÿã‚Šçš„ã€‚å‹™ã‚ã‚’æœãŸã™ã¨è»½ããªã‚‹ã€‚",
  "èƒ":"è‚²ã¦åˆã†ç¸ã€‚é•·æœŸã§èŠ½ãŒå‡ºã‚‹ã€‚"
};
// è·é›¢â†’é–¢ä¿‚ï¼ˆç°¡æ˜“ç‰ˆï¼‰
function relationByDistance(d){
  // 0..26 ã®è·é›¢
  if(d===0) return "å‘½";
  if(d===9||d===18) return d===9?"å‹":"æˆ";
  if(d===1||d===26) return "å±";
  if(d===13) return "æ „";
  if(d===14) return "è¡°";
  if(d===2||d===25) return "å®‰";
  if(d===4||d===23) return "å£Š";
  if(d===8||d===19) return d===8?"æ¥­":"èƒ";
  // ãã‚Œä»¥å¤–ã¯ä¸­åº¸ã¨ã—ã¦ã€Œå‹å¯„ã‚Š/æˆå¯„ã‚Š/è¡°å¯„ã‚Šã€ã‚’è¿‘ä¼¼
  if(d<=6) return "å®‰";
  if(d<=12) return "å‹";
  if(d<=17) return "æˆ";
  return "è¡°";
}

/* ===== ä¹æ˜Ÿæ°—å­¦ï¼ˆæœ¬å‘½æ˜Ÿï¼šç«‹æ˜¥åŸºæº–ï¼‰ ===== */
const KUSEI=["ä¹ç´«ç«æ˜Ÿ","ä¸€ç™½æ°´æ˜Ÿ","äºŒé»’åœŸæ˜Ÿ","ä¸‰ç¢§æœ¨æ˜Ÿ","å››ç·‘æœ¨æ˜Ÿ","äº”é»„åœŸæ˜Ÿ","å…­ç™½é‡‘æ˜Ÿ","ä¸ƒèµ¤é‡‘æ˜Ÿ","å…«ç™½åœŸæ˜Ÿ"]; // 1900åŸºæº–ç”¨ä¸¦ã³
function setsuBun(year){
  // ç«‹æ˜¥ï¼ˆæ¦‚ã­2/4ï¼‰è¿‘ä¼¼ï¼šå¸¸ã«2/4 00:00 ã¨ã™ã‚‹ç°¡æ˜“
  return new Date(Date.UTC(year,1,4,0,0));
}
function honmeisei(date){
  // ç«‹æ˜¥å‰ã¯å‰å¹´æ‰±ã„ï¼ˆç°¡æ˜“ï¼‰ã€‚ä¹æ˜Ÿã¯ 1900å¹´=åºšå­å¹´åŸºæº–â†’ä¹ç´«ç«æ˜Ÿ
  const y=date.getUTCMonth()<1 || (date.getUTCMonth()==1 && date.getUTCDate()<4) ? date.getUTCFullYear()-1 : date.getUTCFullYear();
  // 1900â†’ä¹ç´«(ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0) ã‹ã‚‰ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆ
  const n=((y-1900)%9+9)%9;
  const star=KUSEI[n];
  return star;
}
function houiAdvice(star){
  // è¶…ã–ã£ãã‚Šå¹´å®¶ä¹æ˜Ÿãƒ™ãƒ¼ã‚¹ã®ç›®å®‰ï¼ˆè©³ç´°ã¯å¹´ç›¤ãƒ»æœˆç›¤æ‹¡å¼µã§ä¸Šæ›¸ãæ¨å¥¨ï¼‰
  const good=["æ±","æ±å—","åŒ—"]; // å¸¸ç”¨ã®æˆé•·ãƒ»ç¸ãƒ»æ•´ãˆ
  const care=["è¥¿åŒ—","è¥¿","å—"]; // è¨ˆç”»æ€§ãƒ»å†·é™ã•å¿…é ˆ
  return {good,care,tip:`${star}ã®äººã¯ã€Œæ°´å›ã‚Šã‚’æ¸…æ½”ã€ã€Œå¯å®¤ã‚’æ•´ãˆã‚‹ã€ã€Œç„é–¢ã‚’æ˜ã‚‹ãã€ãŒé‹æ°—åº•ä¸Šã’ã®åŸºæœ¬ã€‚å¼•è¶Šãƒ»æ—…è¡Œã¯å‰æ–¹ã‚’å„ªå…ˆã€‚`};
}

/* ===== å€‹äººæœˆã‚¿ã‚° ===== */
function monthTags(pMonth,shukuName){
  const tags=[],push=(l,c)=>tags.push({l,c});
  const base={
    1:[["å‡ºä¼šã„â—","t-good"],["è»¢è·ã®æº–å‚™â—¯","t-warn"]],
    2:[["æ‹æ„›â—","t-good"],["çµå©šã®è©±â—¯","t-good"]],
    3:[["å‡ºä¼šã„â—¯","t-good"]],
    4:[["å¼•è¶Šã—ä¸‹è¦‹â—¯","t-warn"],["å¥‘ç´„ã¯æ…é‡","t-warn"]],
    5:[["è»¢è·/å¼•è¶Šã—â—","t-good"],["å‹¢ã„å©šæ³¨æ„","t-warn"]],
    6:[["çµå©šâ—","t-good"],["å®¶æ—ãƒ†ãƒ¼ãƒæ¿ƒã„","t-warn"]],
    7:[["é™é¤Š/è¦‹ç›´ã—","t-warn"]],
    8:[["æ˜‡é€²/äº¤æ¸‰â—","t-good"],["å©šç´„ã‚’å›ºã‚ã‚‹â—¯","t-good"]],
    9:[["æ‰‹æ”¾ã—/å®Œäº†","t-warn"],["å¾©ç¸ã¯è¦ç†Ÿè€ƒ","t-bad"]]};
  (base[pMonth]||[]).forEach(x=>push(x[0],x[1]));
  const goodS=["è§’æœ¨è›Ÿ","æˆ¿æ—¥å…","å°¾ç«è™","ç®•æ°´è±¹","æ˜´æ—¥éµ ","å¼µæœˆé¹¿","ç¿¼ç«è›‡","å¥æœ¨ç‹¼","å®¤ç«çŒª","æ˜Ÿæ—¥é¦¬","è»«æ°´èš“"];
  const warnS=["è™šæ—¥é¼ ","é¬¼é‡‘ç¾Š"];
  if(goodS.includes(shukuName)) push("å®¿æ›œï¼šè¿½ã„é¢¨","t-good");
  if(warnS.includes(shukuName)) push("å®¿æ›œï¼šæ…é‡","t-warn");
  return tags;
}

/* ===== ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆï¼ˆèª­ã¿ã‚„ã™ã„èªã‚Šå£ï¼‰ ===== */
function MeiText(lp,shuku){
  const L=LP_PROFILE[lp], S=SHUKU_PROFILE[shuku]||{};
  return `
<p class="lead"><span class="subtitle">ã‚ãªãŸã®æ ¸ï¼š</span> æ•°ç§˜<strong>${lp}</strong>ï¼ˆ${L.title}ï¼‰Ã— å®¿æ›œ<strong>${shuku}</strong>ã€‚</p>
<ul>
  <li><strong>æ€§æ ¼ã®æŸ±ï¼š</strong> ${L.traits}ã€‚</li>
  <li><strong>æ„Ÿæ€§ã®ã‚¯ã‚»ï¼š</strong> ${S.keywords||"çŠ¶æ³è¦³å¯Ÿ"}ã€‚æƒ…ç·’ã¯ã€Œ${S.type||"ä¸­åº¸"}ã€å¯„ã‚Šã€‚</li>
  <li><strong>æ‹ã®ãƒ„ãƒœï¼š</strong> ${L.love}ã€‚å®¿æ›œçš„ã«ã¯ã€Œ${(S.love||"èª å®Ÿã•ã¨ç›¸äº’æˆé•·")}ã€ã€‚</li>
</ul>
<div class="box"><strong>æ´»ã‹ã—æ–¹ã®ã‚³ãƒ„</strong><br>
1) æŒã¡å‘³ã‚’â€œå‹â€ã«ã—ã¦åå¾©ã€‚ 2) æƒ…å ±ã‚ˆã‚Šä½“é¨“ã‚’å¢—ã‚„ã™ã€‚ 3) æ¯æœˆã®ãƒªã‚ºãƒ ã«åˆã‚ã›ã¦äºˆå®šã‚’å…ˆã«ç¢ºå®šã€‚</div>`;
}
function UnText(by,bm,bd){
  const now=new Date(), thisY=now.getFullYear();
  const py=pYear(by,bm,bd,thisY), py2=pYear(by,bm,bd,thisY+1), py3=pYear(by,bm,bd,thisY+2);
  const map={1:"å§‹å‹•ã®å¹´ï¼šã¾ãšå°ã•ãå‹•ãã€‚",2:"äººé–“é–¢ä¿‚ã®å¹´ï¼šèª°ã¨çµ„ã‚€ã‹ã€‚",3:"ç™ºä¿¡ã®å¹´ï¼šPRã¨ä¼ç”»ã€‚",4:"åŸºç›¤ã®å¹´ï¼šä»•çµ„ã¿åŒ–ã¨æ•°å­—ã€‚",5:"è»¢æ©Ÿã®å¹´ï¼šåˆ·æ–°ãƒ»å¼•è¶Šã—ãƒ»è»¢è·â—ã€‚",6:"æ„›ã¨è²¬ä»»ã®å¹´ï¼šçµå©š/å®¶æ—ãŒãƒ†ãƒ¼ãƒã€‚",7:"å†…è¦³ã®å¹´ï¼šå­¦ã³ã¨æ•´ãˆã€‚",8:"æˆæœã®å¹´ï¼šäº¤æ¸‰ãƒ»å€¤ä¸Šã’â—ã€‚",9:"å®Œäº†ã®å¹´ï¼šæ‰‹æ”¾ã—ã¨æµ„åŒ–ã€‚"};
  return `
<p class="lead">ã„ã¾ã€œ3å¹´ã®æµã‚Œï¼ˆæ•°ç§˜ã®å€‹äººå¹´ï¼‰</p>
<ul>
  <li>${thisY}å¹´ï¼š<strong>${py}</strong> â€” ${map[py]}</li>
  <li>${thisY+1}å¹´ï¼š<strong>${py2}</strong> â€” ${map[py2]}</li>
  <li>${thisY+2}å¹´ï¼š<strong>${py3}</strong> â€” ${map[py3]}</li>
</ul>
<div class="box"><strong>ä½¿ã„åˆ†ã‘</strong><br>
æ”»ã‚ã‚‹æœˆï¼š1/5/8ã€€è‚²ã¦ã‚‹æœˆï¼š2/3/6ã€€æ•´ãˆã‚‹æœˆï¼š4/7/9</div>`;
}
function BokuText(pmonth){
  const msg={1:"æ–°ã—ã„ä¸€æ­©ã‚’ã€‚ã¾ãšâ€œè©¦ä½œâ€ã‹ã‚‰ã€‚",2:"äºŒäººä¸‰è„šã§é€²ã‚ã‚‹ã¨é€Ÿã„ã€‚",3:"è¨€è‘‰ã¨è¡¨æƒ…ãŒéµã€‚ç™ºä¿¡é‡ã‚’å¢—ã‚„ã™ã€‚",4:"åœŸå°ã¥ãã‚Šã€‚å°æœ¬ãƒ»æ‰‹é †åŒ–ã€‚",5:"åˆ·æ–°ã®å¥½æ©Ÿã€‚å ´æ‰€ã‚„æ–¹æ³•ã‚’å¤‰ãˆã‚‹ã€‚",6:"ãŠã‚‚ã¦ãªã—ã‚’ç£¨ãã€‚å£ã‚³ãƒŸåé›†ã€‚",7:"ã„ã£ãŸã‚“ä¼‘æ¯ã€‚å­¦ã³ç›´ã—ã€‚",8:"äº¤æ¸‰ã¨å€¤ä¸Šã’ã€‚å®ŸåŠ›ã‚’é€šã™ã€‚",9:"å®Œäº†ãƒ»æµ„åŒ–ã€‚ä½™ç™½ã‚’ä½œã‚‹ã€‚"};
  return `<p class="lead">ä»Šæœˆã®ç©ºæ°—ï¼š<strong>${pmonth}</strong></p><p>${msg[pmonth]||""}</p>`;
}
function CareerLoveText(lp,shuku,gender){
  const L=LP_PROFILE[lp], S=SHUKU_PROFILE[shuku]||{};
  const g=gender==="female"?"ç”·æ€§":"ç›¸æ‰‹";
  const loveMap={
    1:`å°Šæ•¬ã§ãã‚‹${g}ãƒ»è‡ªç«‹ã¨ç›®æ¨™ã‚’æŒã¤äººã€‚`,
    2:`å®‰å¿ƒã¨ã‚„ã•ã—ã•ã€‚é™ã‹ãªãƒªãƒ¼ãƒ€ãƒ¼ã€‚`,
    3:`ä¼šè©±ãŒæ¥½ã—ã„ãƒ»ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã€‚`,
    4:`å …å®Ÿã§ç´„æŸã‚’å®ˆã‚‹ã€‚ç”Ÿæ´»åŠ›ãŒé«˜ã„ã€‚`,
    5:`è‡ªç”±ã§è¡Œå‹•çš„ãƒ»å›½éš›æ„Ÿè¦šã€‚`,
    6:`å®¶æ—è¦³ã®ä¸€è‡´ãƒ»æ¸…æ½”æ„Ÿãƒ»é¢å€’è¦‹ã€‚`,
    7:`çŸ¥æ€§ã¨å°‚é–€æ€§ã€‚è·é›¢æ„Ÿã‚’å°Šé‡ã€‚`,
    8:`é‡å¿ƒã¨åŒ…å®¹åŠ›ã€‚Win-Winã®è¦–ç‚¹ã€‚`,
    9:`ä¸–ç•Œè¦³ã®ä¸€è‡´ãƒ»å„ªã—ã•ã€‚`,
    11:`æ³¢é•·ã®ä¸€è‡´ãƒ»ç›´æ„Ÿã®é€šã˜åˆã„ã€‚`,
    22:`å¤§å¿—ã‚’å…±æœ‰ã§ãã‚‹å®Ÿå‹™å®¶ã€‚`,
    33:`åŒ…å®¹åŠ›ã¨å‰µé€ æ€§ã€‚`
  }[lp];
  const jobs = (L.careers||[]).slice(0,9);
  return `
<p class="lead">å‘ã„ã¦ã„ã‚‹ä»•äº‹ã®æ–¹å‘æ€§</p>
<ul>
  ${jobs.map(j=>`<li>${j}</li>`).join("")}
  <li>å®¿æ›œã®èˆå°ï¼š${S.career||"äººã‚’æ”¯ãˆã‚‹é ˜åŸŸ"}ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼š${S.keywords||"-"}ï¼‰</li>
</ul>
<p class="lead">æƒ¹ã‹ã‚Œã‚„ã™ã„${g}</p>
<p>${loveMap} å®¿æ›œã®æƒ…ç·’å‚¾å‘ã¯ã€Œ${S.love||"èª å®Ÿã•ã¨ç›¸äº’æˆé•·"}ã€ã€‚<br>
<strong>ãƒã‚¤ãƒ³ãƒˆï¼š</strong>å°Šæ•¬ï¼ˆæ•°ç§˜ï¼‰Ã—å®‰å¿ƒï¼ˆå®¿æ›œï¼‰ã‚’ä¸¡ç«‹ã•ã›ã‚‹ã¨é•·æœŸå®‰å®šã€‚</p>`;
}

/* ===== ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æç”» ===== */
function renderCalendar(root, by,bm,bd, shuku){
  root.innerHTML="";
  const now=new Date();
  const start=new Date(Date.UTC(now.getFullYear(), now.getMonth(),1));
  for(let i=0;i<36;i++){
    const d=new Date(Date.UTC(start.getUTCFullYear(),start.getUTCMonth()+i,1));
    const py=pYear(by,bm,bd,d.getUTCFullYear());
    const pm=pMonth(py,d.getUTCMonth()+1);
    const tags=monthTags(pm,shuku);
    const box=document.createElement("div");
    box.className="mon";
    box.innerHTML=`<div class="flex" style="justify-content:space-between"><strong>${d.getUTCFullYear()}å¹´${d.getUTCMonth()+1}æœˆ</strong><span class="pill">å€‹äººæœˆ ${pm}</span></div>
    <div style="margin-top:6px">${tags.map(t=>`<span class="tag ${t.c}">${t.l}</span>`).join("")}</div>
    <div class="small muted" style="margin-top:6px">æ‹æ„›â—:2/6ï½œçµå©šâ—:6/8ï½œå‡ºä¼šã„â—:1/3/5ï½œå¼•è¶Šã—â—:5ï½œè»¢è·â—:1/5/8</div>`;
    root.appendChild(box);
  }
}

/* ===== å®¿æ›œç›¸æ€§ï¼ˆA-Bï¼‰ ===== */
function compatText(idxA, idxB){
  const d=Math.min((idxB-idxA+27)%27,(idxA-idxB+27)%27);
  const rel=relationByDistance(d);
  return {rel, note:REL_TEXT[rel]||"â€”"};
}

/* ===== ãƒ¡ã‚¤ãƒ³ ===== */
document.getElementById("run").addEventListener("click", ()=>{
  const dateA=document.getElementById("birthA").value;
  if(!dateA){alert("ã‚ãªãŸã®ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return;}
  const tzSel=document.getElementById("tz").value||"";
  const utcA=toDateWithTZ(dateA, document.getElementById("timeA").value||"", tzSel);
  const y=utcA.getUTCFullYear(), m=utcA.getUTCMonth()+1, d=utcA.getUTCDate();
  const lp=lifePath(y,m,d);
  const shA=shukuOf(utcA);
  const py=pYear(y,m,d,(new Date()).getFullYear());
  const pmonth=pMonth(py,(new Date()).getMonth()+1);

  // ä¹æ˜Ÿ
  const starA=honmeisei(utcA);
  const houi=houiAdvice(starA);

  // å‡ºåŠ›ãƒ˜ãƒƒãƒ€
  document.getElementById("lifePath").textContent=lp;
  document.getElementById("shukuA").textContent=shA.name;
  document.getElementById("kuseiA").textContent=starA;
  document.getElementById("pyear").textContent=py;

  // æœ¬æ–‡
  document.getElementById("sectionMei").innerHTML=MeiText(lp,shA.name);
  document.getElementById("sectionUn").innerHTML=UnText(y,m,d);
  document.getElementById("sectionBoku").innerHTML=BokuText(pmonth);
  document.getElementById("sectionCareerLove").innerHTML=CareerLoveText(lp,shA.name, document.getElementById("genderA").value||"");

  // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
  renderCalendar(document.getElementById("calendar"), y,m,d, shA.name);

  // ç›¸æ€§
  const dateB=document.getElementById("birthB").value;
  if(dateB){
    const utcB=toDateWithTZ(dateB, document.getElementById("timeB").value||"", tzSel);
    const shB=shukuOf(utcB);
    const c=compatText(shA.idx, shB.idx);
    document.getElementById("compat").innerHTML = `
    <div class="row">
      <div class="box"><strong>ã‚ãªãŸ</strong><br>æœ¬å‘½å®¿ï¼š${shA.name}</div>
      <div class="box"><strong>ç›¸æ‰‹</strong><br>æœ¬å‘½å®¿ï¼š${shB.name}</div>
    </div>
    <p class="lead">é–¢ä¿‚æ€§ï¼š<strong>${c.rel}</strong></p>
    <p>${c.note}</p>
    <ul>
      <li><span class="subtitle">æ‹æ„›ï¼š</span>${c.rel==="æˆ"||c.rel==="å‹"?"ç¾å®ŸåŠ›ãŒã‚ã‚Šé•·æœŸâ—":"ç„¦ã‚‰ãšé–¢ä¿‚è¨­è¨ˆã‚’"}</li>
      <li><span class="subtitle">ä»•äº‹ï¼š</span>${c.rel==="æˆ"?"å½¹å‰²åˆ†æ‹…ã§çˆ†é€Ÿ":"ç›®çš„ã‚’æ˜ç¢ºã«ã—ã¦ä¼šè­°æ™‚é–“ã‚’çŸ­ã"}</li>
      <li><span class="subtitle">æ³¨æ„ï¼š</span>${c.rel==="å±"||c.rel==="å£Š"?"çŸ­æœŸå‹è² /è·é›¢ç®¡ç†/ç¬¬ä¸‰è€…ã®èª¿åœ":"ä¾å­˜ã¨æƒ°æ€§ã«æ³¨æ„"}</li>
    </ul>`;
  }else{
    document.getElementById("compat").innerHTML=`<p class="muted">ç›¸æ‰‹ã®ç”Ÿå¹´æœˆæ—¥ã‚’å…¥ã‚Œã‚‹ã¨ã€é–¢ä¿‚ãƒ©ãƒ™ãƒ«ï¼ˆå®‰ãƒ»æ „ãƒ»å±ãƒ»æˆâ€¦ï¼‰ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>`;
  }

  // ä¹æ˜Ÿ
  document.getElementById("kigaku").innerHTML = `
  <div class="split">
    <div class="box">
      <p class="lead"><strong>æœ¬å‘½æ˜Ÿï¼š</strong>${starA}</p>
      <ul>
        <li>é–‹é‹ã®åŸºæœ¬ï¼šç„é–¢ãƒ»æ°´å›ã‚Šã‚’æ¸…æ½”ã«ã—ã¦å…‰ã‚’å…¥ã‚Œã‚‹</li>
        <li>ä½“èª¿ã®åŸºç¤ï¼šç¡çœ ã‚’æœ€å„ªå…ˆã€æœã®ç™½æ¹¯ã§å·¡ã‚Šã‚¢ãƒƒãƒ—</li>
      </ul>
    </div>
    <div class="box">
      <p class="lead"><strong>æ–¹ä½ã®ç›®å®‰</strong></p>
      <p>å‰æ–¹å€™è£œï¼š${houi.good.join("ãƒ»")}ï¼æ…é‡æ–¹ä½ï¼š${houi.care.join("ãƒ»")}</p>
      <p class="small muted">${houi.tip}<br>â€»å¹´ç›¤ãƒ»æœˆç›¤ãƒ»æ—¥ç›¤ã‚’åˆã‚ã›ã‚‹ã¨ã‚ˆã‚Šæ­£ç¢ºï¼ˆæ‹¡å¼µã§å¯¾å¿œå¯èƒ½ï¼‰ã€‚</p>
    </div>
  </div>`;
});
</script>
</body>
</html>
