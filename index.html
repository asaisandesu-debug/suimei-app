<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>å››æŸ±æ¨å‘½ï¼‹æ•°ç§˜ï¼‹å®¿æ›œ Proï¼ˆã‚„ã•ã—ã„ç·åˆï¼‹3å¹´æ™‚æœŸï½œé«˜ç²¾åº¦27å®¿ï¼‰</title>
<style>
:root{--bg:#0b0c10;--card:#151821;--ink:#f5f7ff;--sub:#b6c0d6;--acc:#7ee1b5;--line:#23283a;--good:#66bb6a;--warn:#ffb74d;--bad:#ef5350}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,"Hiragino Sans","Noto Sans JP",Roboto,Arial;line-height:1.6}
header{padding:14px 14px 8px;background:linear-gradient(180deg,rgba(0,0,0,.55),transparent)}
h1{margin:0;font-size:18px}small{color:var(--sub)}
main{padding:12px}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px;margin:10px 0}
.row{display:flex;gap:8px;flex-wrap:wrap}.col{flex:1 1 160px;min-width:150px}
label{display:block;font-size:12px;color:var(--sub);margin:4px 0 6px}
input,select,button{font-size:16px}
input,select{width:100%;padding:10px;border-radius:12px;border:1px solid var(--line);background:#0e111a;color:#f5f7ff}
.btn{width:100%;padding:12px;border:none;border-radius:12px;font-weight:700;background:var(--acc);color:#0a0a0a}
.kv{display:flex;gap:8px;flex-wrap:wrap}.chip{background:#0e111a;border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:13px}
.note{font-size:13px;color:#cfd7f7;line-height:1.8;display:block;margin:8px 0 12px}
.small{font-size:12px;color:#9fb0d6}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{padding:8px;border-bottom:1px solid var(--line);vertical-align:top}th{white-space:nowrap;color:#cfe0ff;text-align:left}

/* ã‚°ãƒ©ãƒ• */
.bars{position:relative;display:flex;gap:12px;align-items:flex-end;height:180px;border-bottom:1px dashed var(--line);padding:14px 6px 0;margin-top:0}
.barWrap{flex:1;min-width:60px;display:flex;flex-direction:column;align-items:center;justify-content:flex-end}
.bar{width:100%;min-width:44px;border-radius:8px 8px 0 0;background:linear-gradient(180deg,#67e8f9,#22d3ee)}
.barLabel{margin-top:10px;text-align:center;line-height:1.3}
@media(max-width:560px){.bars{gap:10px;height:160px;padding-top:16px}.barWrap{min-width:54px}}

.badge{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;font-size:12px;margin-right:6px}
.tag{display:block;margin:6px 0;padding:6px 10px;border-radius:10px;border:1px solid var(--line);background:#0e111a}
.hr{height:1px;background:var(--line);margin:8px 0}
.grid2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px}
@media(max-width:560px){.grid2{grid-template-columns:1fr}}
.kcell{border:1px solid var(--line);border-radius:10px;padding:8px}
.kcal{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
.km{border:1px solid var(--line);border-radius:10px;padding:8px;text-align:center}
.km b{display:block;margin-bottom:4px}
.hitBoth{border-color:#7ee1b5;background:rgba(126,225,181,.12)}
.hitNum{border-color:#4fc3f7;background:rgba(79,195,247,.08)}
.hitSi{border-color:#ffb74d;background:rgba(255,183,77,.10)}
.marry{outline:2px solid #ffd166; box-shadow:0 0 0 3px rgba(255,209,102,.18) inset}
.err{display:none;background:#331a1a;color:#ffc9c9;border:1px solid #5b2a2a;padding:8px;border-radius:8px;margin-top:6px;font-size:13px}
</style>
</head>
<body>
<header>
  <h1>å››æŸ±æ¨å‘½ï¼‹æ•°ç§˜ï¼‹å®¿æ›œ Pro</h1>
  <small>ã‚„ã•ã—ã„è¨€è‘‰ã§ã€æ‹æ„›ãƒ»æ€§æ ¼ãƒ»ä»•äº‹ãƒ»ç›¸æ€§ãƒ»æ™‚æœŸï¼ˆ3å¹´ï¼‰ï½œ27å®¿ã¯å¤©æ–‡ç®—å‡º</small>
</header>

<main>
  <!-- å…¥åŠ› -->
  <div class="card">
    <div class="row">
      <div class="col"><label>å¹´(è¥¿æš¦)</label><input id="y" type="number" value="1990"></div>
      <div class="col"><label>æœˆ</label><input id="m" type="number" min="1" max="12" value="1"></div>
      <div class="col"><label>æ—¥</label><input id="d" type="number" min="1" max="31" value="1"></div>
      <div class="col"><label>å‡ºç”Ÿæ™‚åˆ»ï¼ˆä»»æ„ ä¾‹ 12:00ï¼‰</label><input id="hm" value="12:00"></div>
    </div>
    <div class="row">
      <div class="col"><label>è”µå¹²ã‚’äº”è¡Œã«å«ã‚ã‚‹</label><select id="zOpt"><option value="on">å«ã‚ã‚‹</option><option value="off">å«ã‚ãªã„</option></select></div>
      <div class="col"><label>è”µå¹²ã‚¦ã‚§ã‚¤ãƒˆ</label><select id="zW"><option value="eq">ç­‰åˆ†</option><option value="pri">ä¸»0.6/æ¬¡0.25/æœ«0.15</option></select></div>
      <div class="col"><label>æœˆæŸ±ã®åˆ¤å®š</label><select id="setu"><option value="const">é«˜ç²¾åº¦ï¼šå®šæ°—æ³•</option><option value="mean">ç°¡æ˜“ï¼šå¹³å‡ç¯€å…¥ã‚Š</option></select></div>
      <div class="col"><label>å®¿æ›œã®åŸºæº–</label>
        <select id="sidOpt">
          <option value="lahiri" selected>ã‚µã‚¤ãƒ‡ãƒªã‚¢ãƒ«ï¼ˆLahiriï¼‰</option>
          <option value="tropical">ãƒˆãƒ­ãƒ”ã‚«ãƒ«ï¼ˆè£œæ­£ãªã—ï¼‰</option>
        </select>
      </div>
    </div>
    <div class="row">
      <div class="col"><label>ã€€</label><button class="btn" id="run">é‘‘å®šã™ã‚‹</button></div>
    </div>
    <div id="err" class="err">æ—¥ä»˜/æ™‚åˆ»ã‚’è¦‹ç›´ã—ã¦ã­</div>
  </div>

  <!-- å‘½å¼ -->
  <div class="card">
    <h3>â—† å‘½å¼ï¼ˆå››æŸ±ï¼‰ï¼‹ã‚„ã•ã—ã„èª­ã¿æ–¹</h3>
    <div class="kv" id="ms"></div>
    <div id="tbl" style="margin-top:8px"></div>
  </div>

  <!-- äº”è¡Œ -->
  <div class="card">
    <h3>â—† äº”è¡Œãƒãƒ©ãƒ³ã‚¹ï¼ˆæœ¨ï¼ç«ï¼åœŸï¼é‡‘ï¼æ°´ï¼‰</h3>
    <div class="note">ã“ã‚Œã¯ã‚ãªãŸã®ã€Œå‚¾å‘ã‚°ãƒ©ãƒ•ã€ã§ã™ã€‚<b>é«˜ã„ï¼ä»Šã®å¼·ã¿</b>ã€<b>ä½ã„ï¼ä¼¸ã°ã™ã¨è‰¯ã„ãƒã‚¤ãƒ³ãƒˆ</b>ã€‚ã‚€ãšã‹ã—ã„è¨€è‘‰ã¯ä½¿ã„ã¾ã›ã‚“ã€‚</div>
    <div id="bars" class="bars"></div>
    <div id="fftags" style="margin-top:6px"></div>
    <div id="fiveExplain" style="margin-top:8px"></div>
  </div>

  <!-- ç·åˆãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
  <div class="card">
    <h3>â—† ç·åˆãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆå››æŸ±ï¼‹æ•°ç§˜ï¼‹å®¿æ›œãƒ»ã‚„ã•ã—ã„è§£èª¬ï¼‰</h3>
    <div class="grid2">
      <div class="kcell"><b>æ€§æ ¼ãƒ»æ‰èƒ½ãƒ»äººé–“é–¢ä¿‚ã®å‚¾å‘</b><div id="traits"></div></div>
      <div class="kcell"><b>æ‹æ„›è¦³ï¼ˆçŸ­ã‚ã‚„ã•ã—ã„é•·æ–‡ï¼‰</b><div id="loveView"></div></div>
      <div class="kcell"><b>ãŠã™ã™ã‚ã®ãƒ“ã‚¸ãƒã‚¹ï¼åƒãæ–¹</b><div id="business"></div></div>
      <div class="kcell"><b>é•·æ‰€ãƒ»çŸ­æ‰€ãƒ»ã‚„ã•ã—ã„ç›´ã—æ–¹</b><div id="strengths"></div></div>
    </div>
    <div class="hr"></div>
    <div class="kcell"><b>å®¿æ›œã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼ˆ27å®¿ãƒ»ã‚„ã•ã—ã„è¨€è‘‰ï¼‰</b><div id="shukuOut" class="note" style="margin-top:4px"></div></div>
  </div>

  <!-- ç›¸æ€§ -->
  <div class="card">
    <h3>â—† ç›¸æ€§ï¼ˆå››æŸ±ï¼‹æ•°ç§˜ï¼‹å®¿æ›œï¼šæ‹æ„›ï¼å‹æƒ…ï¼ãƒ“ã‚¸ãƒã‚¹ï¼‰</h3>
    <div class="row">
      <div class="col"><label>ç›¸æ‰‹ã®å¹´</label><input id="py2" type="number" value="1995"></div>
      <div class="col"><label>ç›¸æ‰‹ã®æœˆ</label><input id="pm2" type="number" min="1" max="12" value="8"></div>
      <div class="col"><label>ç›¸æ‰‹ã®æ—¥</label><input id="pd2" type="number" min="1" max="31" value="15"></div>
      <div class="col"><label>å‡ºç”Ÿæ™‚åˆ»ï¼ˆä»»æ„ï¼‰</label><input id="phm2" placeholder="ä¾‹ 07:20"></div>
      <div class="col"><label>ã€€</label><button class="btn" id="compatBtn">ç›¸æ€§ã‚’è¨ºæ–­</button></div>
    </div>
    <div id="compatOut" style="margin-top:6px"></div>
  </div>

  <!-- æ™‚æœŸ -->
  <div class="card">
    <h3>â—† æ™‚æœŸã®ã‚µã‚¤ãƒ³ï¼ˆã“ã‚Œã‹ã‚‰3å¹´ï¼‰</h3>
    <div class="note">è‰²ï¼š<span class="hitBoth">å››æŸ±ï¼‹æ•°ç§˜ã®ä¸¡æ–¹ã§â—</span>ï¼<span class="hitNum">æ•°ç§˜ã§â—</span>ï¼<span class="hitSi">å››æŸ±ã§â—</span>ã€€ğŸ’ï¼çµå©šã«ç‰¹ã«è‰¯ã„æœˆ</div>
    <div id="timing" class="kcal" style="margin-top:6px"></div>
    <div class="small" id="timingLegend"></div>
    <div class="hr"></div>
    <div class="small" id="marryList"></div>
  </div>
</main>

<script>
/* =========================
   å¹²æ”¯ãƒ»äº”è¡Œ åŸºæœ¬
   ========================= */
var S=["ç”²","ä¹™","ä¸™","ä¸","æˆŠ","å·±","åºš","è¾›","å£¬","ç™¸"],
    SE={"ç”²":"æœ¨","ä¹™":"æœ¨","ä¸™":"ç«","ä¸":"ç«","æˆŠ":"åœŸ","å·±":"åœŸ","åºš":"é‡‘","è¾›":"é‡‘","å£¬":"æ°´","ç™¸":"æ°´"},
    SY={"ç”²":"é™½","ä¹™":"é™°","ä¸™":"é™½","ä¸":"é™°","æˆŠ":"é™½","å·±":"é™°","åºš":"é™½","è¾›":"é™°","å£¬":"é™½","ç™¸":"é™°"};
var B=["å­","ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"],
    MB=["å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥","å­","ä¸‘"];
var ZM={"å­":["å£¬"],"ä¸‘":["å·±","ç™¸","è¾›"],"å¯…":["ç”²","ä¸™","æˆŠ"],"å¯":["ä¹™"],"è¾°":["æˆŠ","ä¹™","ç™¸"],"å·³":["ä¸™","æˆŠ","åºš"],"åˆ":["ä¸","å·±"],"æœª":["å·±","ä¸","ä¹™"],"ç”³":["åºš","å£¬","æˆŠ"],"é…‰":["è¾›"],"æˆŒ":["æˆŠ","è¾›","ä¸"],"äº¥":["å£¬","ç”²"]};
var E=["æœ¨","ç«","åœŸ","é‡‘","æ°´"], GEN={"æœ¨":"ç«","ç«":"åœŸ","åœŸ":"é‡‘","é‡‘":"æ°´","æ°´":"æœ¨"}, CTL={"æœ¨":"åœŸ","åœŸ":"æ°´","æ°´":"ç«","ç«":"é‡‘","é‡‘":"æœ¨"};
var HEX=[["å­","ä¸‘"],["å¯…","äº¥"],["å¯","æˆŒ"],["è¾°","é…‰"],["å·³","ç”³"],["åˆ","æœª"]];
var CHONG=[["å­","åˆ"],["ä¸‘","æœª"],["å¯…","ç”³"],["å¯","é…‰"],["è¾°","æˆŒ"],["å·³","äº¥"]];
var BR_E={"å­":"æ°´","ä¸‘":"åœŸ","å¯…":"æœ¨","å¯":"æœ¨","è¾°":"åœŸ","å·³":"ç«","åˆ":"ç«","æœª":"åœŸ","ç”³":"é‡‘","é…‰":"é‡‘","æˆŒ":"åœŸ","äº¥":"æ°´"};
var PEACH_BY_DAY={"å¯…":"å¯","åˆ":"å¯","æˆŒ":"å¯","ç”³":"é…‰","å­":"é…‰","è¾°":"é…‰","äº¥":"å­","å¯":"å­","æœª":"å­","å·³":"åˆ","é…‰":"åˆ","ä¸‘":"åˆ"};

/* =========================
   äºŒåå››ç¯€æ°—ï¼ˆå®šæ°—ï¼å¹³å‡ï¼‰
   ========================= */
function parseHM(s){if(!s)return[12,0];var m=/^(\d{1,2}):(\d{2})$/.exec(s);if(!m)return[12,0];var h=+m[1],mm=+m[2];return[Math.min(23,Math.max(0,h)),Math.min(59,Math.max(0,mm))];}
function JDN(y,m,d){var a=Math.floor((14-m)/12),y2=y+4800-a,m2=m+12*a-3;return d+Math.floor((153*m2+2)/5)+365*y2+Math.floor(y2/4)-Math.floor(y2/100)+Math.floor(y2/400)-32045;}
function sexIdx(j){var base=JDN(1984,2,2);var diff=j-base;var r=diff%60;if(r<0)r+=60;return r;}
function dayP(y,m,d){var idx=sexIdx(JDN(y,m,d));return [S[idx%10], B[idx%12]];}
function hourB(h){if(h>=23||h<1)return"å­";var M=["ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"];return M[Math.floor((h-1)/2)];}
function hourS(ds,hb){var m={"ç”²":"ç”²","å·±":"ç”²","ä¹™":"ä¸™","åºš":"ä¸™","ä¸™":"æˆŠ","è¾›":"æˆŠ","ä¸":"åºš","å£¬":"åºš","æˆŠ":"å£¬","ç™¸":"å£¬"},base=m[ds],off={"å­":0,"ä¸‘":1,"å¯…":2,"å¯":3,"è¾°":4,"å·³":5,"åˆ":6,"æœª":7,"ç”³":8,"é…‰":9,"æˆŒ":10,"äº¥":11};return S[(S.indexOf(base)+off[hb])%10];}
function tenGod(d,o){var me=SE[d],my=SY[d],oe=SE[o],oy=SY[o]; if(oe===me)return my===oy?"æ¯”è‚©":"åŠ«è²¡"; if(GEN[oe]===me)return my===oy?"åå°":"å°ç¶¬"; if(GEN[me]===oe)return my===oy?"å‚·å®˜":"é£Ÿç¥"; if(CTL[me]===oe)return my===oy?"åè²¡":"æ­£è²¡"; if(CTL[oe]===me)return my===oy?"åå®˜":"æ­£å®˜"; return ""; }
function cnt(stems){var c={"æœ¨":0,"ç«":0,"åœŸ":0,"é‡‘":0,"æ°´":0}; for(var i=0;i<stems.length;i++){var s=stems[i]; if(SE[s]) c[SE[s]]+=1;} return c;}
function add(dst,src,w){w=w||1; for(var k in dst){dst[k]+= (src[k]||0)*w;}}
function inPairs(list,a,b){for(var i=0;i<list.length;i++){var p=list[i]; if((p[0]==a&&p[1]==b)||(p[0]==b&&p[1]==a)) return true;} return false;}

/* å®šæ°—ï¼å¹³å‡ç¯€å…¥ */
function toJD(date){return JDN(date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()) + (date.getUTCHours()-12)/24 + date.getUTCMinutes()/1440;}
function sunLonDeg(jd){var T=(jd-2451545.0)/36525;var L0=(280.46646+36000.76983*T+0.0003032*T*T)%360;var M=357.52911+35999.05029*T-0.0001537*T*T;var C=(1.914602-0.004817*T-0.000014*T*T)*Math.sin(M*Math.PI/180)+(0.019993-0.000101*T)*Math.sin(2*M*Math.PI/180)+0.000289*Math.sin(3*M*Math.PI/180);var trueLon=L0+C;return (trueLon+360)%360;}
function findTermJST(year){
  var out=[],targets=[315,345,15,45,75,105,135,165,195,225,255,285];
  for(var i=0;i<targets.length;i++){
    var approx=new Date(Date.UTC(year, i<11?i+1:0, 4, 6, 0));
    var jd0=toJD(approx), step=0.5/24, best=jd0, last=999;
    for(var k=-240;k<=240;k++){
      var jd=jd0+k*step, lon=sunLonDeg(jd), diff=((lon - targets[i] + 540)%360)-180;
      if(Math.abs(diff)<last){last=Math.abs(diff);best=jd;}
    }
    var d=new Date((best-2440587.5)*86400000); var jst=new Date(d.getTime()+9*3600000);
    out.push(jst);
  }
  return out;
}
var meanSetu=[{m:2,d:4},{m:3,d:6},{m:4,d:5},{m:5,d:6},{m:6,d:6},{m:7,d:7},{m:8,d:7},{m:9,d:7},{m:10,d:8},{m:11,d:7},{m:12,d:7},{m:1,d:6}];
function yearP(y,m,d){try{var terms=findTermJST(y);var risshun=terms[0];var cur=new Date(y,m-1,d,12);var jy=(cur<risshun)?(y-1):y;var yi=((jy-1984)%60+60)%60;return [S[yi%10],B[yi%12]];}catch(e){var before=(m<2)||(m==2&&d<4),jy=before?y-1:y;var yi=((jy-1984)%60+60)%60;return [S[yi%10],B[yi%12]];}}
function monthP(y,m,d,ys){
  function autoIndex(){try{var terms=findTermJST(y);var cur=new Date(y,m-1,d,12);var idx=-1;for(var i=0;i<12;i++){var a=terms[i],b=(i<11?terms[i+1]:findTermJST(y+1)[0]);if(cur>=a&&cur<b){idx=i;break;}}return (idx<0)?11:idx;}catch(e){return meanIndex();}}
  function meanIndex(){var arr=[],i;for(i=0;i<12;i++){var t=meanSetu[i],yy=y,mmm=t.m;if(mmm==1)yy=y+1;arr.push({y:yy,m:mmm,d:t.d,idx:i});}var v=y*10000+m*100+d;for(i=0;i<12;i++){var a=arr[i],tv=a.y*10000+a.m*100+a.d;if(v<tv)return (i+11)%12;}return 11;}
  var idx=(document.getElementById("setu").value==="const")?autoIndex():meanIndex();
  var br=MB[idx]; var map={"ç”²":"ä¸™","å·±":"ç”²","ä¹™":"ä¸™","åºš":"ä¸™","ä¸™":"æˆŠ","è¾›":"æˆŠ","ä¸":"å£¬","å£¬":"å£¬","æˆŠ":"ç”²","ç™¸":"ç”²"}, st=map[ys], si=S.indexOf(st);
  return [S[(si+idx)%10], br];
}

/* =========================
   æ•°ç§˜
   ========================= */
function pad(n){return (n<10?"0":"")+n;}
function reduceNum(n){n=(""+n).replace(/\D/g,"");var s=0;for(var i=0;i<n.length;i++) s+=(+n[i]);if(s===11||s===22||s===33) return s;while(s>9){var t=0;var str=""+s;for(var j=0;j<str.length;j++) t+=(+str[j]);if(t===11||t===22||t===33){s=t;break;}s=t;}return s;}
function lifePath(y,m,d){return reduceNum(""+y+pad(m)+pad(d));}
function birthdayNum(d){return (d>=10)?reduceNum(""+d):d;}
function personalYear(m,d,curY){return reduceNum(reduceNum(""+curY)+reduceNum(""+m)+reduceNum(""+d));}
function personalMonth(py, calMonth){return reduceNum(py + calMonth);}

/* =========================
   å®¿æ›œDBï¼ˆ27å®¿ãƒ•ãƒ«ï¼›ç°¡æ½”ãƒ»ã‚„ã•ã—ã„æ—¥æœ¬èªï¼‰
   ========================= */
const SHUKU_SOFT_DB = {
  "è§’":{e:"æœ¨",intro:"èŠ½ã¶ãã®æ˜Ÿã€‚å§‹ã‚ã‚‹åŠ›ãŒã‚ã‚‹äººã€‚",love:"æ‹ã¯ã‚†ã£ãã‚Šè‚²ã¦ã‚ˆã†ã€‚çŸ­ãä¼ãˆã‚‹ã ã‘ã§ã‚‚å®‰å¿ƒã«ã¤ãªãŒã‚‹ã€‚",work:"æ–°è¦ãƒ»ä¼ç”»ãƒ»é–‹æ‹“ã§åŠ›ã‚’ç™ºæ®ã€‚",meet:"æœã®æ•£æ­©ãƒ»æ–°ã—ã„å ´æ‰€ã¸ã€‚",care:"æ·±å‘¼å¸ã‚’3å›ã€‚ã€ä»Šæ—¥ã¯ã“ã“ã¾ã§ã€ã§OKã€‚",charm:"å°ã•ãªèŠ½ã‚’ä¸å¯§ã«è‚²ã¦ã‚‹åŠ›ãŒé­…åŠ›ã€‚"},
  "äº¢":{e:"æœ¨",intro:"èª‡ã‚Šã®æ˜Ÿã€‚ç¾æ„è­˜ã¨æ­£ç›´ã•ã‚’æŒã¤äººã€‚",love:"è¿·ã£ãŸã‚‰ã€ã‚ã‚ŠãŒã¨ã†ã€ã‚’å…ˆã«ã€‚",work:"å“è³ªãƒ»ç·¨é›†ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»åŸºæº–ä½œã‚Šã€‚",meet:"ç¾è¡“é¤¨ãƒ»é™ã‹ãªå–«èŒ¶ã€‚",care:"å®Œç’§ã‚’ç›®æŒ‡ã—éããªã„æ—¥ã‚’ä½œã‚‹ã€‚",charm:"ã‚„ã•ã—ã„èª‡ã‚ŠãŒé­…åŠ›ã€‚"},
  "æ°":{e:"åœŸ",intro:"å®‰å®šã®æ˜Ÿã€‚åœŸå°ã¥ãã‚ŠãŒå¾—æ„ã€‚",love:"æ—¥ã€…ã®å°ã•ãªæ°—é£ã„ãŒéµã€‚",work:"ç®¡ç†ãƒ»é‹ç”¨ãƒ»ã‚µãƒãƒ¼ãƒˆã«â—ã€‚",meet:"åœ°å…ƒã®å•†åº—è¡—ãƒ»å›³æ›¸é¤¨ã€‚",care:"è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§ç„¡ç†ã‚’ã—ãªã„ã€‚",charm:"å®‰å¿ƒæ„Ÿã‚’è‚²ã¦ã‚‹å­˜åœ¨ã€‚"},
  "æˆ¿":{e:"ç«",intro:"è¯ã®æ˜Ÿã€‚å ´ã‚’æ˜ã‚‹ãã§ãã‚‹äººã€‚",love:"è¤’ã‚è¨€è‘‰ã¯çŸ­ãæ—©ã‚ã«ã€‚",work:"åºƒå ±ãƒ»æ¥å®¢ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆå‘ãã€‚",meet:"ãƒ©ã‚¤ãƒ–ãƒ»ã«ãã‚„ã‹ãªå ´æ‰€ã€‚",care:"ã‚¹ãƒãƒ›ã‚ªãƒ•ã®æ™‚é–“ã‚’å°‘ã—ã€‚",charm:"ç¬‘é¡”ã§ç©ºæ°—ã‚’æ¸©ã‚ã‚‹åŠ›ã€‚"},
  "å¿ƒ":{e:"ç«",intro:"æ„Ÿå—æ€§ã®æ˜Ÿã€‚æ„Ÿã˜ã‚‹åŠ›ãŒãã®ã¾ã¾æ‰èƒ½ã€‚",love:"è¨€è‘‰ã®å‰ã«ä¸€å‘¼å¸ã§ä¼ã‚ã‚Šã‚„ã™ã„ã€‚",work:"ã‚¢ãƒ¼ãƒˆãƒ»ç ”ç©¶ãƒ»ã‚±ã‚¢ã«â—ã€‚",meet:"å¤œã®æ•£æ­©ãƒ»æ°´è¾ºã€‚",care:"å¥½ããªéŸ³æ¥½ã§æ°—åˆ†ã‚’æ•´ãˆã‚‹ã€‚",charm:"æ„Ÿæ€§è±Šã‹ãªè¡¨ç¾è€…ã€‚"},
  "å°¾":{e:"ç«",intro:"ã‚„ã‚ŠæŠœãæ˜Ÿã€‚ç´„æŸã‚’å®ˆã‚‹äººã€‚",love:"ãƒ—ãƒ©ãƒ³å…±æœ‰ã§å®‰å¿ƒæ„ŸãŒå¢—ãˆã‚‹ã€‚",work:"ç· åˆ‡ç®¡ç†ãƒ»å“è³ªç¶­æŒã§è©•ä¾¡ã€‚",meet:"ç¯€ç›®ã®å ´ãƒ»è¨˜å¿µæ—¥ã€‚",care:"ã‚¿ã‚¹ã‚¯ã¯åŠåˆ†ã«åˆ†ã‘ã¦é€²ã‚ã‚‹ã€‚",charm:"è²¬ä»»æ„Ÿã¨ä¸å¯§ã•ã€‚"},
  "ç®•":{e:"æœ¨",intro:"æƒ…å ±ã®æ˜Ÿã€‚è¦ç‚¹ã‚’ã™ãã„å–ã‚Šä¼ãˆã‚‹äººã€‚",love:"ãƒ†ãƒ³ãƒè‰¯ã„é€£çµ¡ãŒå¿ƒåœ°ã‚ˆã•ã«ã€‚",work:"ç·¨é›†ãƒ»åºƒå ±ãƒ»åˆ†æãŒå¾—æ„ã€‚",meet:"å‹‰å¼·ä¼šãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€‚",care:"3è¡Œæ—¥è¨˜ã§é ­ã‚’æ•´ãˆã‚‹ã€‚",charm:"æƒ…å ±ã‚’æ•´ãˆã¦å±Šã‘ã‚‹æ‰ã€‚"},
  "æ–—":{e:"é‡‘",intro:"çµ±ç‡ã®æ˜Ÿã€‚ã¾ã¨ã‚ä¸Šã’ã‚‹åŠ›ã€‚",love:"ç„¦ã‚‰ãšä¿¡é ¼ã®æ™‚é–“ã‚’ç©ã‚€ã€‚",work:"çµ„ç¹”é‹å–¶ãƒ»æ–¹é‡æç¤ºã€‚",meet:"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ãƒ»ãƒãƒ¼ãƒ æ´»å‹•ã€‚",care:"å„ªå…ˆé †ä½ã‚’3ã¤ã«çµã‚‹ã€‚",charm:"å…¨ä½“ã‚’è¦‹ã‚‹è¦–ç‚¹ã€‚"},
  "å¥³":{e:"æ°´",intro:"è´ãæ˜Ÿã€‚ç›¸æ‰‹ã®å¿ƒã‚’å—ã‘ã¨ã‚ã‚‹äººã€‚",love:"è¦ç´„ã§å®‰å¿ƒã‚’ä½œã‚‹ã€‚ã€ã“ã†ã„ã†ã“ã¨ï¼Ÿã€",work:"æ¥é‡ãƒ»ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ãƒ»HRã€‚",meet:"è½ã¡ç€ã„ãŸã‚«ãƒ•ã‚§ã€‚",care:"é™ã‹ãª5åˆ†ã‚’æ¯æ—¥ã€‚",charm:"åŒ…å®¹åŠ›ã®ã‚ã‚‹èãæ‰‹ã€‚"},
  "è™š":{e:"é‡‘",intro:"ç†æƒ³ã®æ˜Ÿã€‚æ–°ã—ã„å½¢ã‚’æƒ³åƒã™ã‚‹äººã€‚",love:"ç†æƒ³ï¼‹ä»Šæ—¥ã®ä¸€æ­©ã‚’è¦‹ã›ã‚ˆã†ã€‚",work:"ITãƒ»ä¼ç”»ãƒ»æˆ¦ç•¥ã«å¼·ã„ã€‚",meet:"ã‚³ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã€‚",care:"æœºã‚’3åˆ†æ•´ãˆã‚‹ã€‚",charm:"ç†æƒ³ã‚’å½¢ã«ã™ã‚‹æ„Ÿåº¦ã€‚"},
  "å±":{e:"åœŸ",intro:"å®ˆã‚Šã®æ˜Ÿã€‚æ…é‡ã•ã¨é…æ…®ã€‚",love:"ä¸å®‰ã¯äº‹å®Ÿã¨æ„Ÿæƒ³ã«åˆ†ã‘ã¦ä¼ãˆã‚‹ã€‚",work:"ç›£æŸ»ãƒ»å“è³ªãƒ»ä¿å®ˆã«å¼·ã¿ã€‚",meet:"é™ã‹ãªå ´æ‰€ãƒ»åº­åœ’ã€‚",care:"è€ƒãˆã‚’ç´™ã«å‡ºã—ã¦è»½ãã™ã‚‹ã€‚",charm:"è½ã¡ç€ã„ãŸåˆ¤æ–­åŠ›ã€‚"},
  "å®¤":{e:"åœŸ",intro:"å®‰å®šã‚’æ”¯ãˆã‚‹æ˜Ÿã€‚ä¿¡é ¼ã‚’ç©ã‚€äººã€‚",love:"ç´„æŸã¯å°‘ãªãç¢ºå®Ÿã«ã€‚",work:"é‹ç”¨ãƒ»çµ„ç¹”é‹å–¶ãƒ»é•·æœŸæ”¯æ´ã€‚",meet:"åœ°åŸŸæ´»å‹•ã€‚",care:"å°ã•ãªå¤‰åŒ–ã‚’è‚¯å®šã™ã‚‹ã€‚",charm:"å¤‰ã‚ã‚‰ã¬ä¿¡é ¼ã€‚"},
  "å£":{e:"åœŸ",intro:"å®ˆè­·ã®æ˜Ÿã€‚æ”¯ãˆã¨ãªã‚‹äººã€‚",love:"å¼±ã•ã‚’å¦å®šã›ãšå—ã‘æ­¢ã‚ã‚‹ã€‚",work:"ãƒãƒƒã‚¯ã‚ªãƒ•ã‚£ã‚¹ãƒ»è‚²æˆãƒ»ä¿å®ˆã€‚",meet:"æ”¯æ´ã®å ´ã€‚",care:"è‡ªåˆ†ã®æ™‚é–“ã‚’å¤§åˆ‡ã«ã€‚",charm:"å®‰å¿ƒã®åœŸå°ã€‚"},
  "å¥":{e:"ç«",intro:"è¡¨ç¾ã®æ˜Ÿã€‚ã“ã¨ã°ã¨ç™ºä¿¡ã®æ‰ã€‚",love:"è¨€ã„éããŸã‚‰ã€ä»Šã®ã¯è¨€ã„éããŸã€ã§æˆ»ã™ã€‚",work:"ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°ãƒ»è¬›å¸«ãƒ»ç™ºä¿¡ã€‚",meet:"èª­æ›¸ä¼šãƒ»è¬›æ¼”ã€‚",care:"è¡¨ç¾ã‚’ä¸€æ–‡ã«ã¾ã¨ã‚ã‚‹ã€‚",charm:"è¨€è‘‰ã§éŸ¿ã‹ã›ã‚‹åŠ›ã€‚"},
  "å©":{e:"åœŸ",intro:"ç©ã¿ä¸Šã’ã®æ˜Ÿã€‚ä¸€æ­©ãšã¤é€²ã‚ã‚‹äººã€‚",love:"ç´„æŸã‚’å®ˆã‚‹ã»ã©ä¿¡é ¼ãŒè‚²ã¤ã€‚",work:"åˆ¶ä½œãƒ»æ•´å‚™ãƒ»é–‹ç™ºã€‚",meet:"å·¥æˆ¿ãƒ»ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã€‚",care:"80ç‚¹ã§å‡ºã™æ—¥ã‚’ä½œã‚‹ã€‚",charm:"ç€å®Ÿãªæ­©ã¿ã€‚"},
  "èƒƒ":{e:"åœŸ",intro:"å®Ÿå‹™ã®æ˜Ÿã€‚ç”Ÿæ´»ã‚’ä¸å¯§ã«æ‰±ã†äººã€‚",love:"ä½“é¨“ãƒ‡ãƒ¼ãƒˆã§è·é›¢ãŒç¸®ã‚€ã€‚",work:"åº—èˆ—ãƒ»æ¥å®¢ãƒ»èª¿é”ã€‚",meet:"å¸‚å ´ãƒ»æ–™ç†æ•™å®¤ã€‚",care:"æ·±å‘¼å¸ï¼‹è‡ªç„¶éŸ³ã€‚",charm:"æš®ã‚‰ã—ã®æ‰ã€‚"},
  "æ˜´":{e:"é‡‘",intro:"å­¦ã³ã®æ˜Ÿã€‚ä¼¸ã³ãŒé€Ÿã„äººã€‚",love:"å­¦ã³ã®å…±æœ‰ãŒçµ†ã«ã€‚",work:"æ•™è‚²ãƒ»ç ”ç©¶ãƒ»ITã€‚",meet:"å›³æ›¸é¤¨ãƒ»å‹‰å¼·ä¼šã€‚",care:"5åˆ†ã ã‘æ–°ã—ã„çŸ¥è­˜ã€‚",charm:"é€Ÿã•ã¨æ¢æ±‚å¿ƒã€‚"},
  "ç•¢":{e:"é‡‘",intro:"è²¬ä»»ã®æ˜Ÿã€‚ã‚„ã‚Šé‚ã’ã‚‹åŠ›ã€‚",love:"æ™‚é–“ã«ä½™è£•ã‚’æŒã£ã¦ç´„æŸã‚’å®ˆã‚‹ã€‚",work:"ç´æœŸç®¡ç†ãƒ»PMã€‚",meet:"æˆæœç™ºè¡¨ã®å ´ã€‚",care:"æŠ±ãˆè¾¼ã¿éããšé ¼ã‚‹ç·´ç¿’ã€‚",charm:"ä¿¡é ¼æ„Ÿã€‚"},
  "è§œ":{e:"é‡‘",intro:"è¨€èªåŒ–ã®æ˜Ÿã€‚èª¬æ˜ãŒå¾—æ„ã€‚",love:"ã€è‰¯ã„æ‰€â†’æ„Ÿè¬ã€ã®é †ã§ä¼ãˆã‚‹ã€‚",work:"ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ»ç¿»è¨³ãƒ»æ³•å‹™ã€‚",meet:"èª­æ›¸ä¼šãƒ»è¨€èªäº¤æµã€‚",care:"æ­£ã—ã•ä¸€è¾ºå€’ã«ãªã‚‰ãªã„ä½™ç™½ã€‚",charm:"æ­£ç¢ºã«ä¼ãˆã‚‹åŠ›ã€‚"},
  "å‚":{e:"æœ¨",intro:"è¡Œå‹•ã®æ˜Ÿã€‚ç‡å…ˆã—ã¦å‹•ã‘ã‚‹äººã€‚",love:"è¿·ã£ãŸã‚‰èª˜ã†ã€‚ã‚·ãƒ³ãƒ—ãƒ«ã§OKã€‚",work:"é–‹æ‹“ãƒ»å–¶æ¥­ãƒ»æ•‘æ€¥å¯¾å¿œã€‚",meet:"ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ã‚¢ã‚¦ãƒˆãƒ‰ã‚¢ã€‚",care:"çªã£èµ°ã‚‰ãšè¨ˆç”»ã‚’ä¸€æšã«ã€‚",charm:"è¡Œå‹•åŠ›ã€‚"},
  "äº•":{e:"æ°´",intro:"èãå‡ºã™æ˜Ÿã€‚å ´ã®æ°´è„ˆã‚’æ¢ã™äººã€‚",love:"ã€ä»Šæ—¥ã®è‰¯ã‹ã£ãŸã“ã¨ã€ã‚’èã„ã¦ã¿ã‚‹ã€‚",work:"ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼ãƒ»äººäº‹ãƒ»æ¥é‡ã€‚",meet:"èªã‚Šå ´ã€‚",care:"å—ã‘èº«éããªã„ã‚ˆã†ç™ºä¿¡ã‚‚å°‘ã—ã€‚",charm:"èãåŠ›ã€‚"},
  "é¬¼":{e:"åœŸ",intro:"æ¢æ±‚ã®æ˜Ÿã€‚é›†ä¸­ã¨æ·±æ˜ã‚Šã€‚",love:"æ¸©åº¦ã¯ã‚†ã£ãã‚Šä¸Šã’ã‚‹æ‹ãŒåˆã†ã€‚",work:"ç ”ç©¶ãƒ»è§£æãƒ»å“è³ªã€‚",meet:"å°‚é–€ã‚¤ãƒ™ãƒ³ãƒˆã€‚",care:"å­¤ç«‹ã—ãªã„ã‚ˆã†é€²æ—ã‚’ä¸€è¨€å…±æœ‰ã€‚",charm:"æ·±ã•ã€‚"},
  "æŸ³":{e:"æœ¨",intro:"é©å¿œã®æ˜Ÿã€‚çŠ¶æ³ã«åˆã‚ã›ã¦å‹•ã‘ã‚‹ã€‚",love:"ç›¸æ‰‹ã®ã“ã ã‚ã‚Šã‚’å°Šé‡ã™ã‚‹ã¨å®‰å®šã€‚",work:"è²©å£²ãƒ»äº¤æ¸‰ãƒ»æ¥å®¢ã€‚",meet:"ç§»å‹•ã—ãªãŒã‚‰ã®äº¤æµã€‚",care:"å„ªå…ˆé †ä½ã‚’3ã¤ã«çµã‚‹ã€‚",charm:"ã—ãªã‚„ã‹ã•ã€‚"},
  "æ˜Ÿ":{e:"ç«",intro:"è¦å¾‹ã®æ˜Ÿã€‚ä¿¡é ¼ã‚’é›†ã‚ã‚‹äººã€‚",love:"çŸ­ã„é€£çµ¡ã®ç¶™ç¶šãŒå®‰å¿ƒã«ã€‚",work:"ä¼šè¨ˆãƒ»æ³•å‹™ãƒ»é‹ç”¨ã€‚",meet:"æ•´ã£ãŸå ´ã€‚",care:"æŸ”ã‚‰ã‹ã„è¨€è‘‰ã‚’1æ–‡æ·»ãˆã‚‹ã€‚",charm:"è¦å¾‹ã¨ä¿¡é ¼ã€‚"},
  "å¼µ":{e:"ç«",intro:"æ‹¡å¼µã®æ˜Ÿã€‚åºƒã’ã‚‹åŠ›ã¨å­˜åœ¨æ„Ÿã€‚",love:"ã€ã¾ãŸä¼šã„ãŸã„ã€ã‚’ç´ ç›´ã«ã€‚",work:"åºƒå ±ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ»å–¶æ¥­ã€‚",meet:"å±•ç¤ºãƒ»ç™ºè¡¨ã€‚",care:"ç›¸æ‰‹ã«è³ªå•ã‚’æŒŸã‚€ã€‚",charm:"åºƒã•ã¨åŒ…å®¹ã€‚"},
  "ç¿¼":{e:"é‡‘",intro:"ç§©åºã®æ˜Ÿã€‚ç­‹ã‚’é€šã™äººã€‚",love:"ç´„æŸã‚’å®ˆã‚‹å§¿ãŒæœ€å¤§ã®é­…åŠ›ã€‚",work:"è¦ç¨‹æ•´å‚™ãƒ»æ•™è‚²ãƒ»çµ±åˆ¶ã€‚",meet:"åˆ¶åº¦è¨­è¨ˆã®è©±é¡Œã€‚",care:"ä¾‹å¤–ã¸ã®é…æ…®ã‚‚å¿˜ã‚Œãªã„ã€‚",charm:"ç­‹ã‚’é€šã™å®‰å¿ƒæ„Ÿã€‚"},
  "è»«":{e:"æ°´",intro:"å¥‰ä»•ã®æ˜Ÿã€‚æ”¯ãˆã‚‹åŠ›ã€‚",love:"ä½“èª¿ã‚„æ°—åˆ†ã‚’æ°—ã¥ã‹ã†è¨€è‘‰ãŒåŠ¹ãã€‚",work:"ç¦ç¥‰ãƒ»ã‚µãƒãƒ¼ãƒˆãƒ»CSã§å…‰ã‚‹ã€‚",meet:"ç›¸è«‡ã®å ´ã€‚",care:"æŠ±ãˆã™ããšå½¹å‰²ã‚’åˆ†ã‘ã‚‹ã€‚",charm:"æ”¯ãˆã‚‹ã‚„ã•ã—ã•ã€‚"}
};

/* =========================
   å®¿æ›œï¼šæœˆé»„çµŒâ†’27å®¿ï¼ˆé«˜ç²¾åº¦ï¼‰
   - Meeusç°¡ç´„å¼ã§æœˆã®è¦–é»„çµŒÎ»ã‚’å–å¾—
   - sidOpt='lahiri' ã®å ´åˆã¯ãƒ©ãƒ’ãƒªãƒ»ã‚¢ãƒ¤ãƒŠãƒ¼ãƒ³ã‚·ãƒ£ã§æ’æ˜Ÿé»„çµŒã¸
   - 360/27=13.333...åº¦ã”ã¨ã«åŒºåˆ†ï¼ˆé–‹å§‹ã¯å©ï¼‰
   å‚è€ƒï¼šåŒºåˆ†ãƒ¬ãƒ³ã‚¸ï¼ˆ0ã€œ13.3=å©ã€â€¦ã€346.6ã€œ360=å¥ï¼‰ã€‚ [oai_citation:2â€¡å®¿æ›œå æ˜Ÿè¡“ æœˆã®å æ˜Ÿå­¦ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸](https://nakshatra.tokyo/01/suku1.html?utm_source=chatgpt.com)
   ========================= */

/* ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ */
function toRadians(d){return d*Math.PI/180;}
function toDegrees(r){return r*180/Math.PI;}
function norm360(d){d%=360; if(d<0)d+=360; return d;}
function jdFromYMDH(y,m,d,h,mi){
  var jd = JDN(y,m,d) + (h-12)/24 + mi/1440; // UTã¨ã—ã¦
  return jd;
}
/* Î”T è¿‘ä¼¼ï¼ˆ1900-2100ã®ç°¡æ˜“å¼ï¼‰ */
function deltaTSeconds(year){
  // Espenak/Pearlé¢¨ã®è¿‘ä¼¼ï¼ˆååˆ†å®Ÿç”¨ï¼‰
  var y=year;
  if(y<1950){var t=(y-1900)/100; return  -2.0 + 50.0*t*t;}
  if(y<=2000){var t=y-2000; return 62.92 + 0.32217*t + 0.005589*t*t;}
  if(y<=2050){var t=y-2000; return 62.92 + 0.32217*t + 0.005589*t*t;}
  var u=y-1820; return -20 + 32*u*u/3600;
}
/* æœˆã®è¦–é»„çµŒï¼ˆMeeusç°¡ç´„ãƒ»ç§’å˜ä½ã§ååˆ†ãªç²¾åº¦ï¼‰ */
function moonLongitudeDegrees(jd){
  // Meeus Chapter 47 ã®ç°¡ç´„ï¼ˆä¸»è¦é …ç›®ï¼‰
  var T=(jd-2451545.0)/36525;
  var L1 = 218.3164477 + 481267.88123421*T - 0.0015786*T*T + T*T*T/538841 - T*T*T*T/65194000; // å¹³é»„çµŒ
  var D  = 297.8501921 + 445267.1114034*T - 0.0018819*T*T + T*T*T/545868 - T*T*T*T/113065000; // æœˆã®å¹³å‡ä¼¸é–‹è§’
  var M  = 357.5291092 + 35999.0502909*T - 0.0001536*T*T + T*T*T/24490000; // å¤ªé™½ã®å¹³å‡è¿‘ç‚¹è§’
  var Mp = 134.9633964 + 477198.8675055*T + 0.0087414*T*T + T*T*T/69699 - T*T*T*T/14712000; // æœˆã®å¹³å‡è¿‘ç‚¹è§’
  var F  = 93.2720950 + 483202.0175233*T - 0.0036539*T*T - T*T*T/3526000 + T*T*T*T/863310000; // æœˆã®æ˜‡äº¤ç‚¹è·é›¢
  var A1 = 119.75 + 131.849*T;
  var A2 = 53.09 + 479264.290*T;
  var A3 = 313.45 + 481266.484*T;

  var E = 1 - 0.002516*T - 0.0000074*T*T;

  // ä¸»è¦é …ï¼ˆMeeusã®è¡¨ã‹ã‚‰æŠœç²‹ï¼šä¸Šä½é …ã ã‘ã§ã‚‚ååˆ†ãªç²¾åº¦ï¼‰
  var terms = [
    [ 0,  0,  1,  0, 6288774],
    [ 2,  0, -1,  0, 1274027],
    [ 2,  0,  0,  0,  658314],
    [ 0,  0,  2,  0,  213618],
    [ 0,  1,  0,  0, -185116],
    [ 0,  0,  0,  2, -114332],
    [ 2,  0, -2,  0,   58793],
    [ 2, -1, -1,  0,   57066],
    [ 2,  0,  1,  0,   53322],
    [ 2, -1,  0,  0,   45758],
    [ 0,  1, -1,  0,   -40923],
    [ 1,  0,  0,  0,   -34720],
    [ 0,  1,  1,  0,   -30383],
    [ 2,  0,  0, -2,    15327],
    [ 0,  0,  1,  2,   -12528],
    [ 0,  0,  1, -2,    10980],
    [ 4,  0, -1,  0,     10675],
    [ 0,  0,  3,  0,     10034],
    [ 4,  0, -2,  0,      8548],
    [ 2,  1, -1,  0,     -7888],
    [ 2,  1,  0,  0,     -6766],
    [ 1,  0, -1,  0,     -5163],
    [ 1,  1,  0,  0,      4987],
    [ 2, -1,  1,  0,      4036],
    [ 2,  0,  2,  0,      3994],
    [ 4,  0,  0,  0,      3861],
    [ 2,  0, -3,  0,      3665],
    [ 0,  1, -2,  0,     -2689],
    [ 2,  0, -1,  2,     -2602],
    [ 2, -1, -2,  0,      2390],
    [ 1,  0,  1,  0,     -2348],
    [ 2, -2,  0,  0,      2236],
    [ 0,  1,  2,  0,     -2120],
    [ 0,  2,  0,  0,     -2069],
    [ 2, -2, -1,  0,      2048],
    [ 2,  0,  1, -2,     -1773],
    [ 2,  0,  0,  2,     -1595],
    [ 4, -1, -1,  0,      1215],
    [ 0,  0,  2,  2,     -1110],
    [ 3,  0, -1,  0,      -892],
    [ 2,  1,  1,  0,      -810],
    [ 4, -1, -2,  0,       759],
    [ 0,  2, -1,  0,      -713],
    [ 2,  2, -1,  0,      -700],
    [ 2,  1,  0, -2,       691],
    [ 2,  2,  0,  0,       596],
    [ 4,  0,  1,  0,       549],
    [ 0,  0,  4,  0,       537]
  ];
  var sumL = 0;
  var Dr=toRadians(D), Mr=toRadians(M), Mpr=toRadians(Mp), Fr=toRadians(F);
  for(var i=0;i<terms.length;i++){
    var t=terms[i], d=t[0], m=t[1], mp=t[2], f=t[3], c=t[4];
    var e = (Math.abs(m)===1?E:(Math.abs(m)===2?E*E:1));
    sumL += c * e * Math.sin( toRadians(d)*Dr + toRadians(m)*Mr + toRadians(mp)*Mpr + toRadians(f)*Fr ); // ã“ã‚Œã¯å¼è¦‹æ „ãˆä¸Šã®æ“¬ä¼¼ã€‚å®Ÿéš›ã¯ä¸‹ã§æ­£ã—ãè¶³ã™
  }
  // â†‘ä¸Šã®1è¡Œã¯è¦‹ã‚„ã™ã•ç”¨ã€‚å®Ÿè¨ˆç®—ã¯ä¸‹ï¼ˆæ­£ã—ãè§’åº¦ã‚’åˆæˆï¼‰
  sumL = 0;
  for(var i=0;i<terms.length;i++){
    var t=terms[i], d=t[0], m=t[1], mp=t[2], f=t[3], c=t[4];
    var e = (Math.abs(m)===1?E:(Math.abs(m)===2?E*E:1));
    var arg = d*Dr + m*Mr + mp*Mpr + f*Fr;
    sumL += c * e * Math.sin(arg);
  }
  // è¿½åŠ é …ï¼ˆç« å‹•ãƒ»è¦–å·®è£œæ­£ã«ç›¸å½“ã™ã‚‹å¾®å°é …ã®ä¸€éƒ¨ï¼‰
  var add = 3958*Math.sin(toRadians(A1)) + 1962*Math.sin(toRadians(L1 - F)) + 318*Math.sin(toRadians(A2));
  var lon = L1 + (sumL + add)/1000000.0; // åº¦
  return norm360(lon);
}

/* ãƒ©ãƒ’ãƒªãƒ»ã‚¢ãƒ¤ãƒŠãƒ¼ãƒ³ã‚·ãƒ£ï¼ˆè¿‘ä¼¼å¤šé …å¼ï¼å¹´ãƒ»æœˆãƒ»æ—¥ã§å¯ï¼‰ */
function lahiriAyanamsaDeg(y,m,d){
  // å‡ºå…¸ç³»ï¼šå®Ÿå‹™çš„ãªç°¡æ˜“å¼ï¼ˆå¹´å§‹+æœˆè£œæ­£ï¼‰ã€‚ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã®ä»£è¡¨å€¤ã¨è¿‘ã„æŒ™å‹•ã€‚ [oai_citation:3â€¡astrobix.com](https://astrobix.com/astrosight/568-ayanamsa-formula.html?utm_source=chatgpt.com)
  // A = 16.90709*(Y/1000) - 0.757371*(Y/1000)^2 - 6.92416
  var Y = y;
  var A = 16.90709*(Y/1000) - 0.757371*(Y/1000)*(Y/1000) - 6.92416;
  var B = ((m-1)+(d/30.0)) * 1.1574074/1000;
  var ay = A + B; // åº¦
  return ay;
}

/* 27å®¿å¢ƒç•Œï¼š0Â°ã€œ13.333...Â°=å© â†’ â€¦ â†’ 346.666...ã€œ360Â°=å¥ï¼ˆé †åºã¯å®¿æ›œ27å®¿ã®ä¸¦ã³ï¼‰ */
const SHUKU_ORDER = ["å©","èƒƒ","æ˜´","ç•¢","è§œ","å‚","äº•","é¬¼","æŸ³","æ˜Ÿ","å¼µ","ç¿¼","è»«","è§’","äº¢","æ°","æˆ¿","å¿ƒ","å°¾","ç®•","æ–—","å¥³","è™š","å±","å®¤","å£","å¥"];

/* å®¿æ›œã®æ±ºå®š */
function getShukuyoAccurate(y,m,d,h,mi){
  var jdUT = jdFromYMDH(y,m,d,h,mi);
  var year=y;
  var lonTrop = moonLongitudeDegrees(jdUT); // è¦–é»„çµŒï¼ˆãƒˆãƒ­ãƒ”ã‚«ãƒ«ï¼‰
  var sidMode = document.getElementById("sidOpt").value;
  var lon = lonTrop;
  if(sidMode==="lahiri"){
    var ay = lahiriAyanamsaDeg(y,m,d);
    lon = norm360(lonTrop - ay);
  }
  var span = 360/27; // 13.333...
  var idx = Math.floor(lon / span);
  if(idx<0) idx=0; if(idx>26) idx=26;
  return SHUKU_ORDER[idx];
}

/* =========================
   ä»¥é™ï¼šUIãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆä¿®æ­£ç‚¹ï¼šè¦‹å‡ºã—å¹³æ˜“åŒ–ï¼‰
   ========================= */

function run(){
  var y=+document.getElementById("y").value, m=+document.getElementById("m").value, d=+document.getElementById("d").value;
  var hm=document.getElementById("hm").value, t=parseHM(hm), hh=t[0], mm=t[1]||0;
  if(!(y>0&&m>=1&&m<=12&&d>=1&&d<=31)){document.getElementById("err").style.display="block";return;}
  document.getElementById("err").style.display="none";

  // æŸ±
  var dp=dayP(y,m,d), ds=dp[0], db=dp[1];
  var yp=yearP(y,m,d), ys=yp[0], yb=yp[1];
  var mp=monthP(y,m,d,ys), ms=mp[0], mb=mp[1];
  var hb=hourB(hh), hs=hourS(ds,hb);

  // å‘½å¼ï¼ˆè¦‹å‡ºã—ã®å°‚é–€èªâ†’å¹³æ˜“åŒ–ï¼‰
  document.getElementById("ms").innerHTML=[
    'å¹´ï¼š<b>'+ys+yb+'</b>ï¼ˆè‚²ã¡/å®¶ï¼‰','æœˆï¼š<b>'+ms+mb+'</b>ï¼ˆç¤¾ä¼š/ä»•äº‹ï¼‰','æ—¥ï¼š<b>'+ds+db+'</b>ï¼ˆä¸­å¿ƒï¼‰','æ™‚ï¼š<b>'+hs+hb+'</b>ï¼ˆè€ƒãˆ/å°†æ¥ï¼‰'
  ].map(x=>'<div class="chip">'+x+'</div>').join('');

  // å‘½å¼è¡¨ï¼ˆã€Œé€šå¤‰æ˜Ÿã€â†’ã€Œæ€§æ ¼ã®æ˜Ÿã€ï¼‰
  var TGtxt={"æ¯”è‚©":"è‡ªåˆ†ã§ã‚„ã‚‹åŠ›","åŠ«è²¡":"ä»²é–“ã¨çªç ´","é£Ÿç¥":"è¡¨ç¾ã¨æ¥½ã—ã•","å‚·å®˜":"æ”¹å–„ã¨åˆ†æ","åè²¡":"ã”ç¸ã¨ãƒãƒ£ãƒ³ã‚¹","æ­£è²¡":"ç´„æŸã¨ä¿¡é ¼","åå®˜":"æŒ‘æˆ¦ã¨è¡Œå‹•","æ­£å®˜":"å½¹å‰²ã¨è©•ä¾¡","åå°":"ã²ã‚‰ã‚ã","å°ç¶¬":"å­¦ã³ã¨ç†è§£"};
  function row(p){var tg=tenGod(ds,p[1]), easy={"æ¯”è‚©":"è‡ªç«‹/è‡ªåˆ†è»¸","åŠ«è²¡":"ä»²é–“ã§çªç ´","é£Ÿç¥":"æ¥½ã—ãè¡¨ç¾","å‚·å®˜":"æ”¹å–„/åˆ†æ","åè²¡":"ã”ç¸ãƒ»è¡Œå‹•","æ­£è²¡":"ç´„æŸãƒ»ä¿¡é ¼","åå®˜":"å°ã•ãæŒ‘æˆ¦","æ­£å®˜":"å½¹å‰²ãƒ»è©•ä¾¡","åå°":"ç›´æ„Ÿã‚’è©¦ã™","å°ç¶¬":"å­¦ã³ã§å¼·åŒ–"}[tg]||"";return '<tr><th>'+p[0]+'</th><td>'+p[1]+'</td><td>'+p[2]+'</td><td>'+(tg?tg:"â€”")+'</td><td>'+(tg?TGtxt[tg]:"â€”")+'</td><td class="small">'+p[3]+'ï½œ'+easy+'</td></tr>';}
  document.getElementById("tbl").innerHTML='<table><thead><tr><th>æŸ±</th><th>å¤©å¹²</th><th>åœ°æ”¯</th><th>æ€§æ ¼ã®æ˜Ÿ</th><th>æ„å‘³</th><th>ã‚„ã•ã—ã„èª­ã¿æ–¹</th></tr></thead><tbody>'+
    [["å¹´æŸ±",ys,yb,"å®¶ã®é›°å›²æ°—"],["æœˆæŸ±",ms,mb,"ç¤¾ä¼šã§ã®é¡”"],["æ—¥æŸ±",ds,db,"æ€§æ ¼ã®æ ¸å¿ƒ"],["æ™‚æŸ±",hs,hb,"è€ƒãˆ/å°†æ¥åƒ"]].map(row).join('')+
  '</tbody></table>';

  // äº”è¡Œï¼ˆè”µå¹²è¾¼ã¿ï¼‰
  function zWeights(z){var l=ZM[z]||[]; if(l.length==1)return[1]; if(document.getElementById("zW").value==="eq"){return l.map(()=>1/l.length);} return l.length==2?[0.65,0.35]:[0.6,0.25,0.15].slice(0,l.length);}
  var vis=cnt([ys,ms,ds,hs]), zc={"æœ¨":0,"ç«":0,"åœŸ":0,"é‡‘":0,"æ°´":0}, pillars=[[ys,yb],[ms,mb],[ds,db],[hs,hb]];
  for(var i=0;i<pillars.length;i++){var zlist=ZM[pillars[i][1]]||[], w=zWeights(pillars[i][1]); for(var j=0;j<zlist.length;j++){add(zc,cnt([zlist[j]]), w[j]||0);}}
  var useZ=document.getElementById("zOpt").value==="on", total={}; E.forEach(e=>total[e]=(vis[e]||0)+(useZ?zc[e]||0:0));

  var nameLabel={"æœ¨":"æœ¨","ç«":"ç«","åœŸ":"åœŸ","é‡‘":"é‡‘","æ°´":"æ°´"};
  var mx=Math.max.apply(null,E.map(e=>total[e]||0));
  var bars=E.map(function(e){
    var h=mx?Math.round((total[e]||0)/mx*140)+10:10;
    return '<div class="barWrap"><div class="bar" style="height:'+h+'px"></div>'+
           '<div class="barLabel small">'+nameLabel[e]+'<br>'+((total[e]||0).toFixed(2))+'</div></div>';
  }).join('');
  document.getElementById("bars").innerHTML=bars;

  // äº”è¡Œãƒ†ã‚­ã‚¹ãƒˆï¼ˆç¦æ­¢èªãªã„è¡¨ç¾ï¼‰
  var meaning={
    "æœ¨":{title:"æœ¨ï¼šè‚²ã¦ã‚‹ï¼ˆå­¦ã³ãƒ»æˆé•·ï¼‰",
      weapon:"ã€è‚²ã¦ã‚‹åŠ›ã€ãŒå¼·ã¿ã€‚äººã‚„ä¼ç”»ã‚’å°ã•ãªèŠ½ã‹ã‚‰å¤§ããã§ãã‚‹ã€‚",
      signs:"ã€æ–°ã—ã„ã“ã¨ã«ãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã«ãã„ã€ã€äººã«ã‚„ã•ã—ãã™ã‚‹ä½™è£•ãŒãªã„ã€ã¨æ„Ÿã˜ãŸã‚‰ä¼‘æ†©ã‚µã‚¤ãƒ³ã€‚",
      action:"æœã«æ—¥å…‰ã‚’3åˆ†æµ´ã³ã‚‹â†’ãã®æ—¥ã²ã¨ã¤æ–°ã—ã„ã“ã¨â†’å¤œã«ä¸€è¨€æ„Ÿæƒ³ã€‚"
    },
    "ç«":{title:"ç«ï¼šæƒ…ç†±ï¼ˆç™ºä¿¡ãƒ»ç†±æ„ï¼‰",
      weapon:"ã€æƒ…ç†±ã¨ç™ºä¿¡åŠ›ã€ãŒå¼·ã¿ã€‚çŸ­ã„è¨€è‘‰ã‚„è¡Œå‹•ã§æ€ã„ã‚’è¦‹ã›ã‚‹ã»ã©ä¼ã‚ã‚‹ã€‚",
      signs:"ã€ã‚„ã‚‹æ°—ãŒç¶šã‹ãªã„ã€ã€æ°—æŒã¡ãŒä¼ã‚ã‚‰ãªã„ã€æ—¥ã¯ãƒªã‚ºãƒ èª¿æ•´ã€‚",
      action:"ç™½æ¹¯â†’æ·±å‘¼å¸â†’ã€ä»Šæ—¥ã¯ã“ã“ãŒè‰¯ã‹ã£ãŸã€ã‚’å£ã«å‡ºã™ã€‚"
    },
    "åœŸ":{title:"åœŸï¼šæ•´ãˆã‚‹ï¼ˆå®‰å®šãƒ»è¨ˆç”»ï¼‰",
      weapon:"ã€æ®µå–ã‚Šã€ãŒå¼·ã¿ã€‚æ‰‹é †ãŒè¦‹ãˆã‚‹ã¨ã¿ã‚“ãªãŒå‹•ãã‚„ã™ã„ã€‚",
      signs:"ã€å¾Œå›ã—ãŒå¢—ãˆã‚‹ã€ã€ã‚¿ã‚¹ã‚¯ãŒã”ã¡ã‚ƒã¤ãã€æ™‚ã¯åœ°ãªã‚‰ã—ã€‚",
      action:"5åˆ†ç‰‡ã¥ã‘â†’ä»Šæ—¥ã‚„ã‚‹3ã¤â†’1ã¤ã ã‘ç€æ‰‹ã€‚"
    },
    "é‡‘":{title:"é‡‘ï¼šç£¨ãï¼ˆåˆ¤æ–­ãƒ»ãƒ«ãƒ¼ãƒ«ï¼‰",
      weapon:"ã€ç£¨ãåŠ›ã€ãŒå¼·ã¿ã€‚ãƒ ãƒ€ã‚’æ¸›ã‚‰ã—ã¦å¤§äº‹ãªã‚‚ã®ã‚’å…‰ã‚‰ã›ã‚‹ã€‚",
      signs:"ã€é¸ã¹ãªã„ã€ã€æƒ…å ±ãŒå¤šã„ã€æ—¥ã¯è»½ãã™ã‚‹æ—¥ã«ã€‚",
      action:"ã„ã‚‰ãªã„ç‰©ã‚’1ã¤æ‰‹æ”¾ã™â†’5åˆ†æ•´ãˆã‚‹â†’è¦ç‚¹3ã¤ã«ã€‚"
    },
    "æ°´":{title:"æ°´ï¼šã¤ãªãï¼ˆæƒ…å ±ãƒ»å¯¾è©±ï¼‰",
      weapon:"ã€ã¤ãªãåŠ›ã€ãŒå¼·ã¿ã€‚èª¿ã¹ã¦ã¾ã¨ã‚ã€æ©‹æ¸¡ã—ãŒã§ãã‚‹ã€‚",
      signs:"ã€è¨€è‘‰ãŒå‡ºã«ãã„ã€ã€ã¾ã¨ã¾ã‚‰ãªã„ã€æ™‚ã¯é ­ã‚’æµã™ã€‚",
      action:"3è¡Œæ—¥è¨˜â†’ã²ã¨ã“ã¨ãƒ¡ãƒ¢â†’5ã€œ10åˆ†ã®æ•£æ­©ã€‚"
    }
  };
  var sumVal=E.reduce((a,k)=>a+(total[k]||0),0)||1, avg=sumVal/5;
  function levelName(v){ if(v>=avg*1.15) return "strong"; if(v<=avg*0.85) return "train"; return "normal"; }
  var ord=E.slice().sort((a,b)=>(total[b]||0)-(total[a]||0));
  document.getElementById("fftags").innerHTML=
    '<span class="badge">ä»Šã®å¼·ã¿ï¼š'+nameLabel[ord[0]]+'</span>'+
    '<span class="badge">ä¼¸ã°ã™ã¨è‰¯ã„ï¼š'+nameLabel[ord[4]]+'</span>';
  document.getElementById("fiveExplain").innerHTML=E.map(function(k){
    var v=(total[k]||0), lv=levelName(v), x=meaning[k];
    var head=(lv==="strong"?"ä»Šã®å¼·ã¿":lv==="train"?"ä¼¸ã°ã™ã¨è‰¯ã„":"ãµã¤ã†ï¼ˆOKï¼‰");
    var body=(lv==="strong")?x.weapon:(lv==="train")?("ã‚ˆãã‚ã‚‹ã‚µã‚¤ãƒ³ï¼š"+x.signs+" ï¼ ä»Šæ—¥ã®å…·ä½“ç­–ï¼š"+x.action):"ä»Šã®ãƒšãƒ¼ã‚¹ã§å¤§ä¸ˆå¤«ã€‚";
    return '<div class="tag">'+x.title+' ï¼ <b>'+head+'</b> â†’ '+body+'</div>';
  }).join('');

  // é€šå¤‰æ˜Ÿã‚«ã‚¦ãƒ³ãƒˆãƒ»æ•°ç§˜
  var tgAll={}, pillarsGan=[ys,ms,hs];
  pillarsGan.forEach(g=>{var t=tenGod(ds,g); if(t) tgAll[t]=(tgAll[t]||0)+1;});
  (ZM[db]||[]).forEach(zg=>{var t=tenGod(ds,zg); if(t) tgAll[t]=(tgAll[t]||0)+1;});
  var topTG=Object.keys(tgAll).sort((a,b)=>(tgAll[b]||0)-(tgAll[a]||0));
  var lp=lifePath(y,m,d), bd=birthdayNum(d);

  // æ€§æ ¼ãƒ»äººé–“é–¢ä¿‚
  var traits=[];
  if(topTG[0]) traits.push('æ€§æ ¼ã®æ ¸ï¼š<b>'+topTG[0]+'</b>ï¼ˆ'+{"æ¯”è‚©":"è‡ªåˆ†ã§æ±ºã‚ã¦å‹•ã‘ã‚‹åŠ›","åŠ«è²¡":"äººã‚’å·»ãè¾¼ã‚“ã§é€²ã‚€åŠ›","é£Ÿç¥":"æ¥½ã—ã•ã¨è¡¨ç¾ã§å‘¨ã‚Šã‚’æ˜ã‚‹ãã™ã‚‹åŠ›","å‚·å®˜":"ç´°ã‹ãè¦‹ã¦è‰¯ãã—ã¦ã„ãåŠ›","åè²¡":"ã”ç¸ã‚’ã¤ã‹ã‚€è¡Œå‹•åŠ›","æ­£è²¡":"ã‚³ãƒ„ã‚³ãƒ„ä¿¡é ¼ã‚’ãŸã‚ã‚‹åŠ›","åå®˜":"æŒ‘æˆ¦ã—ã¦ä¼¸ã³ã‚‹å®Ÿæˆ¦åŠ›","æ­£å®˜":"å½¹å‰²ã‚’å®ˆã£ã¦è©•ä¾¡ã‚’ä¸Šã’ã‚‹åŠ›","åå°":"ã²ã‚‰ã‚ãã‚’å½¢ã«ã™ã‚‹åŠ›","å°ç¶¬":"å­¦ã³ã‚’è²¯ã‚ã¦ä¼ãˆã‚‹åŠ›"}[topTG[0]]+'ï¼‰');
  traits.push('äººé–“é–¢ä¿‚ï¼š<b>'+(SE[ds]===SE[ms]?"ä¼¼ãŸå¼·ã¿ã‚’è¤’ã‚åˆã†ã¨æœ€å¼·":"é•ã„ã¯â€œå½¹å‰²åˆ†æ‹…â€ã«ã™ã‚‹ã¨å™›ã¿åˆã†")+'</b>');
  document.getElementById("traits").innerHTML=traits.map(x=>'<div class="tag">'+x+'</div>').join('');

  // æ‹æ„›è¦³ï¼ˆçŸ­ã‚ãƒ»ã‚„ã•ã—ã„ï¼‰
  function loveText(lp,eCore,tgLead,db){
    var base={
      "æœ¨":"æ‹ã¯ã€è‚²ã¦ã‚‹ã€ã€‚ä¼šè©±ã‚’é‡ã­ã¦å®‰å¿ƒã‚’å¢—ã‚„ãã†ã€‚",
      "ç«":"æ‹ã¯ã€æƒ…ç†±ã€ã€‚è¨€è‘‰ã¨è¡Œå‹•ã§æ€ã„ã‚’è¦‹ã›ã‚ˆã†ã€‚",
      "åœŸ":"æ‹ã¯ã€å®‰å¿ƒè¨­è¨ˆã€ã€‚ç´„æŸã¨é€£çµ¡ã®ãƒ«ãƒ¼ãƒ«ã‚’æ•´ãˆã‚ˆã†ã€‚",
      "é‡‘":"æ‹ã¯ã€ã¦ã„ã­ã„ã•ã€ã€‚æ¸…æ½”æ„Ÿã¨å°ã•ãªæ°—ã¥ã‹ã„ãŒéµã€‚",
      "æ°´":"æ‹ã¯ã€å¯¾è©±ã€ã€‚çŸ­ã„è¨€è‘‰ã§æ°—æŒã¡ã‚’ä¼ãˆã‚ˆã†ã€‚"
    }[eCore];
    var lpAdd={1:"ãƒªãƒ¼ãƒ‰ä¸Šæ‰‹ã€‚ç›¸æ‰‹ã®æ°—æŒã¡ã‚’å…ˆã«èãã¨ä¿¡é ¼UPã€‚",2:"å¯„ã‚Šãã†å¤©æ‰ã€‚æˆ‘æ…¢ã—ã™ãæ³¨æ„ã€‚",3:"æ¥½ã—ã„æ‹ã€‚ãƒ‰ã‚¿ã‚­ãƒ£ãƒ³æ³¨æ„ã€‚",4:"å®‰å®šé‡è¦–ã€‚å°†æ¥åƒã®å…±æœ‰ãŒæ±ºã‚æ‰‹ã€‚",5:"è‡ªç”±æ´¾ã€‚é€£çµ¡ãƒ«ãƒ¼ãƒ«ã‚’å…ˆã«æ±ºã‚ã¦å¹³å’Œã€‚",6:"ä¸–è©±ç„¼ãã€‚è‡ªåˆ†ã‚±ã‚¢ã®æ—¥ã‚’ä½œã‚ã†ã€‚",7:"ä¸€äººæ™‚é–“ãŒç‡ƒæ–™ã€‚é™ã‹ãªç†è§£è€…ã«æƒ¹ã‹ã‚Œã‚‹ã€‚",8:"é ¼ã‚Œã‚‹äººã€‚ãŒã‚“ã°ã‚Šã™ããŸã‚‰ç”˜ãˆã‚‹æ—¥ã‚’ã€‚",9:"å…±æ„Ÿå‹ã€‚å¢ƒç•Œç·šã‚‚å¤§äº‹ã«ã€‚",11:"ç›´æ„Ÿé‡è¦–ã€‚ç„¦ã‚‰ãšè‚²ã¦ã‚ˆã†ã€‚",22:"å¤§ããªç›®æ¨™ã‚’ä¸€ç·’ã«è¿½ã†ã¨æœ€å¼·ã€‚",33:"åŒ…å®¹åŠ›ã®å¡Šã€‚æŠ±ãˆè¾¼ã¿ã™ãæ³¨æ„ã€‚"}[lp];
    var tgAdd={"æ¯”è‚©":"ã€ç§ã¯ã“ã†ã—ãŸã„ã€ã‚’ç´ ç›´ã«ã€‚","åŠ«è²¡":"ä¸€ç·’ã«ä½œæˆ¦ä¼šè­°ãŒè¿‘é“ã€‚","é£Ÿç¥":"ç¬‘é¡”ã¨ãƒ¦ãƒ¼ãƒ¢ã‚¢ãŒæ­¦å™¨ã€‚","å‚·å®˜":"ãƒ€ãƒ¡å‡ºã—ã¯ã€ææ¡ˆã®å½¢ã€ã§ã€‚","åè²¡":"ä¼šã†å›æ•°ï¼å®‰å¿ƒã€‚è»½ã„èª˜ã„ã‚’å¢—ã‚„ãã†ã€‚","æ­£è²¡":"å°ã•ãªç´„æŸã‚’å®ˆã‚‹ã»ã©é€²å±•ã€‚","åå®˜":"å‹¢ã„ã¯é­…åŠ›ã€‚ä¸€å‘¼å¸ç½®ã„ã¦ã‹ã‚‰ã€‚","æ­£å®˜":"ç¤¼å„€ã¨è½ã¡ç€ããŒå¥½å°è±¡ã€‚","åå°":"ç›´æ„Ÿã ã‘ã«é ¼ã‚‰ãšè¨€è‘‰ã§è£œè¶³ã€‚","å°ç¶¬":"å­¦ã³åˆã„ãŒé•·ç¶šãã®éµã€‚"}[tgLead]||"";
    var peach = PEACH_BY_DAY[db] ? "ã‚ãªãŸã®æ—¥æ”¯ã€Œ"+db+"ã€ã®ã€å‡ºä¼šã„é‹ãŒä¸ŠãŒã‚‹å¹²æ”¯ã€ã¯ã€Œ"+PEACH_BY_DAY[db]+"ã€ã€‚" : "";
    return [base,lpAdd,tgAdd,peach].filter(Boolean).map(s=>'<div class="note">'+s+'</div>').join("");
  }
  document.getElementById("loveView").innerHTML=loveText(lp,SE[ds],topTG[0],db);

  // ãƒ“ã‚¸ãƒã‚¹
  var strong=ord[0], weak=ord[4];
  var bizMap={"æœ¨":"æ•™è‚²/è‚²æˆ/ä¼ç”»","ç«":"åºƒå ±/è²©å£²/ã‚¨ãƒ³ã‚¿ãƒ¡","åœŸ":"ç®¡ç†/ç·å‹™/å“è³ª","é‡‘":"æ³•å‹™/è²¡å‹™/å¯©æŸ»/ãƒ‡ã‚¶ã‚¤ãƒ³","æ°´":"IT/æƒ…å ±/ç ”ç©¶/ä¼é”"};
  var lpJob={1:"èµ·æ¥­/å–¶æ¥­/ä¼ç”»/ç®¡ç†",2:"äººäº‹/ç§˜æ›¸/æ¥å®¢/ã‚±ã‚¢",3:"ãƒ‡ã‚¶ã‚¤ãƒ³/åºƒå ±/æ•™è‚²",4:"çµŒç†/è¡Œæ”¿/å»ºç¯‰/å“è³ª",5:"å–¶æ¥­/æ—…è¡Œ/ãƒãƒ¼ã‚±/é€šè¨³",6:"åŒ»ç™‚/ç¦ç¥‰/ç¾å®¹/æ•™è‚²",7:"ç ”ç©¶/åˆ†æ/é–‹ç™º/ã‚³ãƒ³ã‚µãƒ«",8:"ç®¡ç†è·/ä¸å‹•ç”£/é‡‘è",9:"æ•™è‚²/ç¦ç¥‰/ä¼ç”»/åºƒå ±",11:"ã‚¢ãƒ¼ãƒˆ/è¡¨ç¾/ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°",22:"çµŒå–¶/ç¤¾ä¼šäº‹æ¥­/å»ºè¨­/ä»•çµ„ã¿åŒ–",33:"æ•™è‚²/ã‚±ã‚¢/è¡¨ç¾/ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£"};
  var roleTip={"æœ¨":"ä¼ç”»/è‚²æˆã®å½¹","ç«":"åºƒå ±/æ¨é€²ã®å½¹","åœŸ":"é€²è¡Œ/å“è³ªã®å½¹","é‡‘":"ç›£æŸ»/æ•´å‚™ã®å½¹","æ°´":"æƒ…å ±/åˆ†æã®å½¹"}[strong];
  document.getElementById("business").innerHTML=[
    'äº”è¡Œã®å¼·ã¿ï¼š<b>'+nameLabel[strong]+'</b> â†’ '+bizMap[strong],
    'æ•°ç§˜ã®é©è·ï¼š<b>'+lp+'</b> â†’ '+lpJob[lp],
    'ãƒãƒ¼ãƒ ã®å½¹å‰²ï¼š<b>'+roleTip+'</b>',
    'ä¼¸ã°ã™ãƒã‚¤ãƒ³ãƒˆï¼š<b>'+nameLabel[weak]+'</b> â†’ '+{"æœ¨":"æœæ—¥ã¨ã‚¹ãƒˆãƒ¬ãƒƒãƒï¼‹â€œã‚ã‚ŠãŒã¨ã†â€","ç«":"ç™½æ¹¯â†’ä¸€è¨€ãƒã‚¸ãƒ†ã‚£ãƒ–ç™ºä¿¡","åœŸ":"å°ã•ãªç· åˆ‡ã§â€œã‚„ã‚‹æ—¥/ä¼‘ã‚€æ—¥â€","é‡‘":"æ¨ã¦1ãƒ»æ•´ãˆ5åˆ†ãƒ»è¦ç‚¹3ã¤","æ°´":"3è¡Œæ—¥è¨˜ãƒ»æ•£æ­©ãƒ»å¯¾è©±"}[weak]
  ].map(x=>'<div class="note">'+x+'</div>').join("");

  // é•·æ‰€ãƒ»çŸ­æ‰€ï¼ˆç¦æ­¢èªä¿®æ­£æ¸ˆï¼‰
  var deepShort={"æœ¨":{pro:"é¢å€’è¦‹ã¨æˆé•·åŠ›",con:"æ€ã„ã‚„ã‚ŠãŒå¼·ã™ãã‚‹ã¨è‡ªåˆ†ã‚’å¾Œå›ã—ã«ã—ã‚„ã™ã„"}, "ç«":{pro:"æƒ…ç†±ã§äººã‚’å‹•ã‹ã™",con:"å‹¢ã„ãŒå¼·ã„ã¨ç›¸æ‰‹ãŒç–²ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹"}, "åœŸ":{pro:"å®‰å®šã¨ç¶™ç¶š",con:"æ…é‡ã™ãã‚‹ã¨æ©Ÿä¼šã‚’é€ƒã—ã‚„ã™ã„"}, "é‡‘":{pro:"åŸºæº–ã¨å“è³ª",con:"å®Œç’§ã‚’æ±‚ã‚ã™ãã‚‹ã¨é…ããªã‚‹"}, "æ°´":{pro:"æƒ…å ±åé›†ã¨ä¼é”",con:"è€ƒãˆã™ãã‚‹ã¨å‹•ã‘ãªã„ã“ã¨ãŒã‚ã‚‹"}};
  var fix={"æœ¨":"æ¯æœ5åˆ†ã®å­¦ã³","ç«":"ç™½æ¹¯ï¼‹ä¸€è¨€ãƒã‚¸ãƒ†ã‚£ãƒ–","åœŸ":"å°ã•ãªç· åˆ‡ã‚’ç½®ã","é‡‘":"5åˆ†ç‰‡ä»˜ã‘/åŸºæº–æ±ºã‚","æ°´":"3è¡Œæ—¥è¨˜/æ•£æ­©/å¯¾è©±"};
  var strengths=['é•·æ‰€ï¼š<b>'+nameLabel[strong]+'</b>ï¼ˆ'+deepShort[strong].pro+'ï¼‰ã‚’å‰ã«å‡ºã™ã€‚',
                 'çŸ­æ‰€ï¼š<b>'+nameLabel[weak]+'</b> â†’ '+deepShort[weak].con+'ã€‚ã ã‹ã‚‰â€œ'+fix[weak]+'â€ã‚’ç¿’æ…£ã«ã€‚'];
  if(topTG[0]==="å‚·å®˜") strengths.push('ï¼»æ³¨æ„ï¼½ãƒ€ãƒ¡å‡ºã—ã¯â€œææ¡ˆã®å½¢â€ã§ã€‚æ™‚é–“ã‚’åŒºåˆ‡ã£ã¦å‡ºã™ã€‚');
  if(topTG[0]==="åå®˜") strengths.push('ï¼»æ³¨æ„ï¼½å‹¢ã„ä½™ã‚Šã‚„ã™ã„ â†’ ä¸€å‘¼å¸ç½®ã„ã¦ã‹ã‚‰è©±ã™ã€‚');
  if(topTG[0]==="æ­£è²¡") strengths.push('ï¼»æ³¨æ„ï¼½æŠ±ãˆè¾¼ã¿ã™ã â†’ å½¹å‰²åˆ†æ‹…ã¨ç· åˆ‡å…±æœ‰ã€‚');
  document.getElementById("strengths").innerHTML=strengths.map(x=>'<div class="note">'+x+'</div>').join("");

  // å®¿æ›œï¼ˆé«˜ç²¾åº¦ç®—å‡ºï¼‰
  var shuku=getShukuyoAccurate(y,m,d,hh,mm);
  document.getElementById("shukuOut").innerHTML=(function(name){
    var x=SHUKU_SOFT_DB[name];
    if(!x)return '<div class="tag">æœ¬å‘½å®¿ï¼š<b>'+name+'</b>ï¼ˆæº–å‚™ä¸­ï¼‰</div>';
    return '<div class="tag"><b>æœ¬å‘½å®¿ï¼š'+name+'</b>ï¼ˆ'+x.e+'ã®æ°—è³ªï¼‰</div>'+
           '<p class="note">ã€ã‚ãªãŸã¯ã€‘'+x.intro+'</p>'+
           '<p class="note">ã€æ‹æ„›ã€‘'+x.love+'</p>'+
           '<p class="note">ã€ãŠä»•äº‹ã€‘'+x.work+'</p>'+
           '<p class="note">ã€å‡ºä¼šã„ã€‘'+x.meet+'</p>'+
           '<p class="note">ã€ã“ã“ã‚ã‚±ã‚¢ã€‘'+x.care+'</p>'+
           '<p class="note"><b>'+x.charm+'</b></p>';
  })(shuku);

  // ===== ç›¸æ€§ï¼ˆç•¥ï¼šå‰ç‰ˆã¨åŒç­‰ã€å®¿ã®ã¿é«˜ç²¾åº¦ç®—å‡ºã¸å·®ã—æ›¿ãˆï¼‰ =====
  document.getElementById("compatBtn").onclick=function(){
    var y2=+document.getElementById("py2").value, m2=+document.getElementById("pm2").value, d2=+document.getElementById("pd2").value;
    var hm2=document.getElementById("phm2").value||"12:00", t2=parseHM(hm2), hh2=t2[0], mm2=t2[1]||0;
    if(!(y2>0&&m2>=1&&m2<=12&&d2>=1&&d2<=31)){document.getElementById("compatOut").innerHTML="<div class='err' style='display:block'>ç›¸æ‰‹ã®ç”Ÿå¹´æœˆæ—¥ã‚’æ­£ã—ãå…¥ã‚Œã¦ã­</div>"; return;}
    var dp2=dayP(y2,m2,d2), ds2=dp2[0], db2=dp2[1];
    var lp1=lifePath(y,m,d), lp2=lifePath(y2,m2,d2);
    function gScore(a,b){var s=50,ea=SE[a],eb=SE[b]; if(GEN[ea]===eb)s+=12; if(GEN[eb]===ea)s+=12; if(CTL[ea]===eb)s-=14; if(CTL[eb]===ea)s-=14; if(SY[a]===SY[b])s+=6; else s-=4;return Math.max(0,Math.min(100,s));}
    var H={ "å…­åˆ":HEX, "å†²":CHONG, "å®³":[["å­","æœª"],["ä¸‘","åˆ"],["å¯…","å·³"],["å¯","è¾°"],["ç”³","äº¥"],["é…‰","æˆŒ"]] };
    function zScore(a,b){var s=50; if(inPairs(H["å…­åˆ"],a,b))s+=20; if(inPairs(H["å†²"],a,b))s-=18; if(inPairs(H["å®³"],a,b))s-=8; return Math.max(0,Math.min(100,s));}
    var siJuScore=Math.round(gScore(ds,ds2)*0.6 + zScore(db,db2)*0.4);
    var NCbase={1:{1:70,2:78,3:85,4:76,5:82,6:74,7:80,8:88,9:75,11:86,22:84,33:80},2:{1:78,2:72,3:77,4:82,5:74,6:86,7:80,8:70,9:83,11:85,22:76,33:84},3:{1:85,2:77,3:75,4:72,5:88,6:80,7:78,8:79,9:84,11:86,22:78,33:90},4:{1:76,2:82,3:72,4:74,5:70,6:80,7:85,8:86,9:73,11:78,22:88,33:76},5:{1:82,2:74,3:88,4:70,5:76,6:73,7:80,8:78,9:84,11:86,22:80,33:82},6:{1:74,2:86,3:80,4:80,5:73,6:78,7:76,8:82,9:88,11:84,22:80,33:86},7:{1:80,2:80,3:78,4:85,5:80,6:76,7:74,8:82,9:79,11:88,22:84,33:78},8:{1:88,2:70,3:79,4:86,5:78,6:82,7:82,8:76,9:80,11:84,22:90,33:80},9:{1:75,2:83,3:84,4:73,5:84,6:88,7:79,8:80,9:76,11:86,22:82,33:88},11:{1:86,2:85,3:86,4:78,5:86,6:84,7:88,8:84,9:86,11:82,22:86,33:90},22:{1:84,2:76,3:78,4:88,5:80,6:80,7:84,8:90,9:82,11:86,22:84,33:86},33:{1:80,2:84,3:90,4:76,5:82,6:86,7:78,8:80,9:88,11:90,22:86,33:84}};
    var numScore=(NCbase[lp1]&&NCbase[lp1][lp2])||75;
    var loveScore=Math.round(siJuScore*0.65 + numScore*0.35);
    var friendScore=Math.round(siJuScore*0.5 + numScore*0.5);
    var roleBoost=0; if(GEN[SE[ds]]===SE[ds2]) roleBoost+=4; if(CTL[SE[ds]]===SE[ds2]) roleBoost+=3;
    var bizScore=Math.max(0,Math.min(100, Math.round(siJuScore*0.6 + numScore*0.4 + roleBoost)));
    function face(s){return s>=86?"â—":(s>=80?"â—¯":(s>=74?"â–³":"â–²"));}

    var sh1=getShukuyoAccurate(y,m,d,hh,mm), sh2=getShukuyoAccurate(y2,m2,d2,hh2,mm2);
    var shLine='å®¿æ›œï¼šã‚ãªãŸã€Œ'+sh1+'ã€Ã— ç›¸æ‰‹ã€Œ'+sh2+'ã€ã€‚é•ã„ã¯ä¾¡å€¤è¦³ã®é•ã„ï¼æ­¦å™¨ã€‚å…±é€šç‚¹ã¯â€œå®‰å¿ƒâ€ã€‚';

    var talkTips=["â‘ æ°—æŒã¡ â‘¡ç†ç”± â‘¢ãŠé¡˜ã„ï¼ˆçŸ­ãï¼‰","ã€ã†ã‚Œã—ã‹ã£ãŸâ†’å›°ã£ãŸâ†’ã“ã†ã—ãŸã„ã€","çµè«–â†’ç†ç”±â†’ä¸€ç·’ã®ä¸€æ­©"];
    var tt=talkTips[(y+m+d+y2+m2+d2)%talkTips.length];

    function loveAdvice(s){
      var a=[];
      if(s<75)a.push("ã™ã‚Œé•ã„ã¯ã€"+tt+"ã€ã§çŸ­ãã€‚é•·æ–‡ã‚ˆã‚ŠçŸ­æ–‡ãŒå®‰å¿ƒã€‚");
      if(inPairs(HEX, db, db2))a.push("ç›¸æ€§â—ï¼ˆå…­åˆï¼‰ï¼šä¼šã†å›æ•°ã‚’å°‘ã—å¢—ã‚„ã™ã»ã©ä»²è‰¯ã—ã«ã€‚");
      if(inPairs(CHONG, db, db2))a.push("è¡çªã—ã‚„ã™ã„ï¼šå…ˆã«ã‚´ãƒ¼ãƒ«ã‚’ä¸€æ–‡ã§æ±ºã‚ã¦ã‹ã‚‰è©±ãã†ã€‚");
      a.push("è¿·ã£ãŸã‚‰ã€Œ"+({"æœ¨":"æ•£æ­©ã‚„æœ¬å±‹","ç«":"ãƒ©ã‚¤ãƒ–ã‚„å¤–é£Ÿ","åœŸ":"å®¶ã”ã¯ã‚“ã‚„ç‰‡ã¥ã‘","é‡‘":"ç¾è¡“é¤¨ã‚„é™ã‹ãªå ´æ‰€","æ°´":"ã‚«ãƒ•ã‚§ã§ã‚†ã£ãã‚Š"}[SE[ds]])+"ã€ãŒå¤±æ•—ã—ã«ãã„ã€‚");
      return a.join(" ");
    }
    function friendAdvice(s){
      var a=[];
      if(s<75)a.push("é€£çµ¡é »åº¦ï¼ˆé€±1/éš”é€±ï¼‰ã‚’æœ€åˆã«åˆæ„ã€‚");
      a.push((CTL[SE[ds]]===SE[ds2]||CTL[SE[ds2]]===SE[ds])?"ã€ä¼ç”»/ã¾ã¨ã‚/é€£çµ¡ã€ã®å½¹å‰²åˆ†æ‹…ã§æ‘©æ“¦å›é¿ã€‚":"å…±é€šã®è¶£å‘³æ™‚é–“ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å›ºå®šã€‚");
      a.push("ã€ã‚ã‚ŠãŒã¨ã†ã€ã¯ãã®æ—¥ã®ã†ã¡ã«çŸ­æ–‡ã§ã€‚");
      return a.join(" ");
    }
    function bizAdvice(s){
      var a=[];
      if(GEN[SE[ds]]===SE[ds2])a.push("ã‚ãªãŸâ†’ç›¸æ‰‹ï¼šè‚²æˆ/ã‚³ãƒ¼ãƒé©æ€§ã€‚");
      if(CTL[SE[ds]]===SE[ds2])a.push("ã‚ãªãŸâ†’ç›¸æ‰‹ï¼šKPIã‚„ç· åˆ‡è¨­è¨ˆã‚’æ‹…å½“ã€‚");
      if(CTL[SE[ds2]]===SE[ds])a.push("ç›¸æ‰‹â†’ã‚ãªãŸï¼šé€²æ—ãƒã‚§ãƒƒã‚¯ã‚’ä»»ã›ã‚‹ã€‚");
      a.push("æœ€åˆã«ã€èª°ãŒæ±ºã‚ã‚‹ï¼ä½•ã‚’æ±ºã‚ã‚‹ï¼ã„ã¤ã¾ã§ã€ã‚’å®£è¨€ã€‚å…±æœ‰ãƒ¡ãƒ¢ã§é€æ˜åŒ–ã€‚");
      return a.join(" ");
    }

    var html='';
    html+='<div class="kv"><div class="chip">ã‚ãªãŸï¼š<b>'+ds+db+'</b> / é‹å‘½æ•°<b>'+lp1+'</b> / å®¿ï¼š'+sh1+'</div><div class="chip">ç›¸æ‰‹ï¼š<b>'+ds2+db2+'</b> / é‹å‘½æ•°<b>'+lp2+'</b> / å®¿ï¼š'+sh2+'</div></div><div class="hr"></div>';
    html+='<div><b>å››æŸ±ã®ç›¸æ€§</b>ï¼š'+siJuScore+'/100ã€€<b>æ•°ç§˜ã®ç›¸æ€§</b>ï¼š'+numScore+'/100</div><div class="small">'+shLine+'</div><div class="hr"></div>';
    html+='<div><b>ç·åˆï¼ˆæ‹æ„›ï¼‰</b>ï¼š'+loveScore+'/100 '+face(loveScore)+'<br><span class="small">'+loveAdvice(loveScore)+'</span></div>';
    html+='<div style="margin-top:6px"><b>ç·åˆï¼ˆå‹æƒ…ï¼‰</b>ï¼š'+friendScore+'/100 '+face(friendScore)+'<br><span class="small">'+friendAdvice(friendScore)+'</span></div>';
    html+='<div style="margin-top:6px"><b>ç·åˆï¼ˆãƒ“ã‚¸ãƒã‚¹ï¼‰</b>ï¼š'+bizScore+'/100 '+face(bizScore)+'<br><span class="small">'+bizAdvice(bizScore)+'</span></div>';
    document.getElementById("compatOut").innerHTML=html;
  };

  // ===== æ™‚æœŸï¼ˆ36ã‹æœˆï¼‰ =====ï¼ˆå‰ç‰ˆåŒç­‰ï¼‰
  function bestNumMonths(kind){var sets={love:[2,3,6], meet:[3,5], job:[1,5,8], ind:[1,8]}; return sets[kind||'love']||[2,3,6];}
  var meE=SE[ds], wealthE=CTL[meE];
  var controlsMeE=(function(){for(var k in CTL){if(CTL[k]===meE)return k;}return null;})();
  function monthBranch(y,m,d){ return monthP(y,m,d,yearP(y,m,d)[0])[1]; }

  var today=new Date(), startY=today.getFullYear(), startM=today.getMonth()+1;
  var cells=[], marryMonths=[];
  for(var i=0;i<36;i++){
    var Y=startY+Math.floor((startM-1+i)/12);
    var M=((startM-1+i)%12)+1;

    var br=monthBranch(Y,M,15), brE=BR_E[br];
    var curPY=personalYear(m,d,Y), pm=personalMonth(curPY,M);

    var numLove=bestNumMonths('love').indexOf(pm)>=0;
    var numMeet=bestNumMonths('meet').indexOf(pm)>=0;
    var numJob =bestNumMonths('job').indexOf(pm)>=0;
    var numInd =bestNumMonths('ind').indexOf(pm)>=0;

    var siMeet = (br===PEACH_BY_DAY[db]);
    var siLove = (brE===wealthE) || siMeet;
    var siJob  = (brE===controlsMeE);
    var siInd  = (brE===wealthE);

    function cls(b1,b2){return b1&&b2?"hitBoth":(b1?"hitNum":(b2?"hitSi":""));}

    var marryHit = ( (numLove && siLove) || (siLove && siMeet) || (numLove && siMeet) );

    var divCls=cls((numLove||numMeet||numJob||numInd),(siLove||siJob||siInd)) + (marryHit?' marry':'');
    var label=Y+"å¹´"+M+"æœˆï¼ˆ"+br+"ï¼‰";
    var detail=[];
    if(numLove||siLove) detail.push("æ‹æ„›â—");
    if(numMeet||siMeet) detail.push("å‡ºä¼šã„â—");
    if(numJob ||siJob ) detail.push("è»¢è·â—");
    if(numInd ||siInd ) detail.push("ç‹¬ç«‹â—");
    if(marryHit) { detail.push("ğŸ’çµå©šâ—"); marryMonths.push(label); }
    if(detail.length===0) detail.push("æ§˜å­è¦‹");

    cells.push('<div class="km '+divCls+'"><b>'+label+'</b>'+detail.join("ãƒ»")+'</div>');
  }
  document.getElementById("timing").innerHTML=cells.join('');
  document.getElementById("timingLegend").innerHTML="â€» â€œæ‹/çµå©šâ€ã¯æ•°ç§˜ï¼ˆ2/3/6ï¼‰ï¼‹å››æŸ±ã®è²¡ã®æœˆ/æ¡ƒèŠ±æœˆã€â€œè»¢è·â€ã¯æ•°ç§˜ï¼ˆ1/5/8ï¼‰ï¼‹å››æŸ±ã®å®˜ã®æœˆã€â€œç‹¬ç«‹â€ã¯æ•°ç§˜ï¼ˆ1/8ï¼‰ï¼‹å››æŸ±ã®æ¡ä»¶ã§åˆ¤å®šã€‚è‰²ã¯Wâ—/æ•°ç§˜â—/å››æŸ±â—ã€‚";
  document.getElementById("marryList").innerHTML = (marryMonths.length? "ğŸ’ <b>çµå©šã«è‰¯ã„æœˆï¼š</b> "+marryMonths.join("ã€") : "ğŸ’ çµå©šã¯ç„¦ã‚‰ãšã€æº–å‚™ã®å¹´ã€‚");
}

function init(){ document.getElementById("run").addEventListener("click",run); document.getElementById("compatBtn").addEventListener("click",function(){}); run(); }
document.addEventListener("DOMContentLoaded",init);
</script>
</body>
</html>
